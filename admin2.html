<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
    <title>Epic Catalogue - Admin Panel</title>
    <link rel="icon" href="./imgs/admin.png" />
    <link rel="preload" href="./css/admin.css" as="style" onload="this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="./css/admin.css?version=3.2">
    </noscript>
    <link rel="manifest" href="/dev.webmanifest">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
</head>

<body data-theme="dark">

    <canvas id="overlay" class="fixed inset-0 pointer-events-none"
        style="pointer-events:none;position: fixed;z-index: 9999999;"></canvas>
    <div id="login-overlay">
        <div class="login-card">
            <div class="garagedoor">
                <div class="texture-overlay"></div>
                <div class="endofdoor"></div>
            </div>
            <img src="./imgs/eng.png">
            <div id="welcome-label"></div>
            <h2>Admin Login</h2>
            <input type="password" id="admin-key" placeholder="Enter admin key" />
            <button id="login-btn">Login</button>

            <div id="login-error"></div>
        </div>
    </div>
    <svg style="position:absolute;width:0;height:0">
        <filter id="frosted" primitiveUnits="objectBoundingBox">
            <feImage
                href="data:image/png;base64,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"
                x="0" y="0" width="1" height="1" result="map" />
            <feGaussianBlur in="SourceGraphic" stdDeviation="0.02" result="blur" />
            <feDisplacementMap id="disp" in="blur" in2="map" scale="1" xChannelSelector="R" yChannelSelector="G">
                <animate attributeName="scale" to="1.4" dur="0.3s" begin="btn.mouseover" fill="freeze" />
                <animate attributeName="scale" to="1" dur="0.3s" begin="btn.mouseout" fill="freeze" />
            </feDisplacementMap>
        </filter>
    </svg>


    <header>

        <h1><img src="./imgs/eng.png" style="width: 52px;">Epic Catalogue<strong
                style="font-variant-caps: all-petite-caps;">Admin Panel</strong></h1>
        <div id="top-controls">
            <div class="tag" id="admin-online" style="display: flex;flex-direction: row-reverse;gap:4px;">connecting...
            </div>
            <div id="settings-btn">âš™</div>
        </div>
        <div id="settings-menu">
            <h2>Settings</h2>
            <label>Theme
                <select id="theme-select">
                    <option value="dark">Dark</option>
                    <!--     <option value="light">Light</option> -->
                </select>
            </label>
            <label>Quick actions</label>
            <button id="download-json" class="small-btn ghost">
                <p class="icon"
                    style="mask-image: url('data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!--%20License%3A%20PD.%20Made%20by%20mono-company%3A%20https%3A%2F%2Fgithub.com%2Fmono-company%2Fmono-icons%20--%3E%3Csvg%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M12%202a1%201%200%200%201%201%201v10.586l2.293-2.293a1%201%200%200%201%201.414%201.414l-4%204a1%201%200%200%201-1.414%200l-4-4a1%201%200%201%201%201.414-1.414L11%2013.586V3a1%201%200%200%201%201-1zM5%2017a1%201%200%200%201%201%201v2h12v-2a1%201%200%201%201%202%200v2a2%202%200%200%201-2%202H6a2%202%200%200%201-2-2v-2a1%201%200%200%201%201-1z%22%2F%3E%3C%2Fsvg%3E');">
                </p>
                Download JSON
            </button>
            <button id="logout">
                <p class="icon"
                    style="mask-image: url('data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!--%20License%3A%20PD.%20Made%20by%20mono-company%3A%20https%3A%2F%2Fgithub.com%2Fmono-company%2Fmono-icons%20--%3E%3Csvg%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M2%206a2%202%200%200%201%202-2h9a2%202%200%200%201%202%202v2a1%201%200%201%201-2%200V6H4v12h9v-2a1%201%200%201%201%202%200v2a2%202%200%200%201-2%202H4a2%202%200%200%201-2-2V6zm15.293%202.293a1%201%200%200%201%201.414%200l3%203a1%201%200%200%201%200%201.414l-3%203a1%201%200%200%201-1.414-1.414L18.586%2013H9a1%201%200%201%201%200-2h9.586l-1.293-1.293a1%201%200%200%201%200-1.414z%22%2F%3E%3C%2Fsvg%3E');">
                </p>
                Logout
            </button>
            <div style="height:8px"></div>
            <div class="note">Tip: edits modify the loaded list in memory.<br>Click SAVE to publish to website.</div>
        </div>

    </header>

    <main>
        <div id="quick-editor-spacer" style="visibility: hidden;width: 424px;" class="initial"></div>
        <div id="main-content">
            <div class="section" id="lists-section">
                <h2>Shops</h2>
                <div style="display:flex;gap:12px;margin-bottom:28px;flex-wrap:wrap">
                    <div class="panel" style="flex:1;">
                        <div
                            style="font-weight:700;margin-bottom:8px;font-variant-caps: all-small-caps;margin-top: -10px;font-size: 20px;">
                            Weekly Shop</div>
                        <div id="weekly-items" class="grid"></div>
                    </div>
                    <div class="panel" style="flex:1;">
                        <div
                            style="font-weight:700;margin-bottom:8px;font-variant-caps: all-small-caps;margin-top: -10px;font-size: 20px;">
                            Star Shop</div>
                        <div id="weeklystar-items" class="grid"></div>
                    </div>
                </div>

                <div class="panel" style="margin-top:8px">
                    <div class="flex" style="margin-bottom:22px">
                        <input id="search" placeholder="Search items..."
                            style="flex:1;border-radius:8px;border:1px solid var(--ghost);background:transparent;color:var(--muted)">
                        <i class="icon"></i>
                        <select id="category-filter">
                            <option value="all">All categories</option>

                        </select>
                        <button id="gamenight-toggle" class="small-btn ghost">ðŸŽ® Gamenight Only</button>
                        <select id="sort-select">
                            <option value="default">Default</option>
                            <option value="az">A â†’ Z</option>
                            <option value="za">Z â†’ A</option>
                            <option value="high">$$$ â†’ $</option>
                            <option value="low">$ â†’ $$$</option>
                        </select>
                        <button class="small-btn" id="toggle-prices">Show prices</button>
                    </div>
                    <div id="all-items" class="grid"></div>
                    <div style="display:flex;justify-content:center;gap:8px;margin-top:19px;align-items:center">
                        <button id="prev-btn" class="small-btn ghost">â—€ Prev</button>
                        <div id="page-count" class="note">Page 1 of 1</div>
                        <button id="next-btn" class="small-btn ghost">Next â–¶</button>
                    </div>
                </div>
            </div>

            <div class="section" id="history-section">
                <h2>History</h2>
                <div id="history-list"></div>
            </div>
            <div class="section" id="notes-section">
                <h2>Notes</h2>
                <div class="board-container">
                    <div class="notes-area" id="notesArea">

                    </div>
                    <button class="add-button" id="addButton" onclick="toggleAddForm()">+</button>
                    <div class="input-form" id="inputForm">
                        <input type="text" class="note-input" id="noteInput" placeholder="Type your note..."
                            maxlength="200">
                        <button class="send-btn" onclick="sendNote()">
                            <p class="icon"
                                style="mask-image: url('data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M12%202a1%201%200%200%201%20.894.553l9%2018a1%201%200%200%201-1.11%201.423L12%2020.024l-8.783%201.952a1%201%200%200%201-1.111-1.423l9-18A1%201%200%200%201%2012%202zm1%2016.198l6.166%201.37L13%207.236v10.962zM11%207.236L4.834%2019.568%2011%2018.198V7.236z%22%2F%3E%3C%2Fsvg%3E');">
                            </p>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Quick Editor Side Modal -->
    <div id="quick-editor-modal" class="hidden">
        <div id="quick-editor-content" class="initial">
            <div id='tutorial'>
                <h1>Quick Editor</h1>
                <p style="color: #f0f8ff;">Double Click a item to Start editing.</p>
                <p style="color: #f0f8ffc9;">Drag the panel to move it around.</p>
                <p style="color: #f0f8ff8f;">Use the "Save" button to apply changes.</p>
                <p style="color: #f0f8ff6e;">Click the "Close" button to hide.</p>
            </div>
            <button id="quick-editor-close" title="Close">&times;</button>
            <h2 id="quick-editor-title"></h2>
            <div class="quick-editor-body">
                <img id="quick-editor-img" src="" alt="" />


                <div class="price-tag">
                    <div class="tag-left"></div>
                    <div class="price-area">
                        <input id="quick-editor-price" style="caret-color: #ffffff30; border: 0px;" type="text"
                            placeholder="OwO" />
                    </div>
                </div>


                <div class="flag-row"
                    style="flex-wrap: wrap;margin-top: 50px;display: flex; gap: 6px; width: 100%; justify-content: center;">
                </div>

            </div>
            <hr>
            <div>
                <label style="margin-top: -9px;position: relative;z-index: 1;">Code / Rarity / Priceâ†´<h1>?</h1>
                    <p>Coins,
                        Stars, %, Opals, Baubles, Tokens, Eggs, Pumpkins, Visors, Robux, Unobtainable
                    </p>
                    <ul class="prc-list">
                        <li>
                            <input id="quick-editor-prc-item" type="text" />
                        </li>
                    </ul>

                </label>
                <button style="padding-bottom: 8px;margin-bottom: 0px;" id="new-prc-btn">Code / Rarity /
                    Price</button>
            </div>

            <div style="margin-top: 21px;">
                <label style="margin-top: -31px;">Descriptionsâ†´<br>
                    <ul class="desc-list">
                        <li>
                            <input id="quick-editor-description-item" type="text" />
                        </li>
                    </ul>

                </label>
                <button id="new-desc-btn">Text</button>
                <button id="new-gn-btn">Gamenight Date</button>
            </div>
        </div>
    </div>


    <button id="save-btn"><b>âœ”</b> Publish</button>


    <script>

        document.getElementById('admin-key').focus()

        let storedContent = null;
        let arrowoff = false

        let ws;
        let backoff = 1000;
        const recentAdmins = new Map(); // adminName -> {lastSeen, pillEl}
        const recentDuration = 5000; // ms for yellow pill

        let myAdminName = "myAdminName"; // replace with your admin name

        function updateAdminOnline(currentAdmins) {
            const container = document.getElementById("admin-online");
            container.innerHTML = "";
            const now = Date.now();

            currentAdmins.forEach(admin => {
                if (recentAdmins.has(admin)) {
                    const info = recentAdmins.get(admin);
                    info.lastSeen = now;

                    const dot = info.pillEl.querySelector('.dot');
                    if (dot) dot.style.backgroundColor = 'limegreen';
                    info.pillEl.style.opacity = '1';

                    if (admin === myAdminName) {
                        container.prepend(info.pillEl); // put your pill first
                    } else {
                        container.appendChild(info.pillEl);
                    }
                } else {
                    const pill = document.createElement("div");
                    pill.style.cssText = `
                        display:flex;
                        align-items:center;
                        gap:6px;
                        padding:4px 10px;
                        border-radius:20px;
                        font-size:14px;
                        font-weight:500;
                        color:#fff;
                        transition: opacity 1s, background 0.5s;
                    `;

                    // Highlight your own pill
                    if (admin === myAdminName) {
                        pill.style.background = 'rgba(100, 100, 255, 0.4)'; // subtle blue highlight
                        pill.style.marginLeft = '8px'; // subtle blue highlight
                        pill.appendChild(document.createTextNode(admin));
                        container.prepend(pill); // ensure your pill is always first
                    } else {
                        pill.style.background = 'rgba(255, 255, 255, 0.05)';
                        const dot = document.createElement("span");
                        dot.className = "dot";
                        dot.style.cssText = `
                    width:10px;
                    height:10px;
                    border-radius:50%;
                    display:inline-block;
                    background-color: limegreen;
                `;
                        pill.appendChild(dot);
                        const name = document.createElement("span");
                        name.textContent = admin;
                        pill.appendChild(name);
                        container.appendChild(pill);
                    }

                    recentAdmins.set(admin, { lastSeen: now, pillEl: pill });
                }
            });

            // Fade offline admins (skip your own)
            recentAdmins.forEach((info, admin) => {
                if (!currentAdmins.includes(admin) && admin !== myAdminName) {
                    const timeSinceLastSeen = now - info.lastSeen;
                    const dot = info.pillEl.querySelector('.dot');
                    if (timeSinceLastSeen < recentDuration) {
                        if (dot) dot.style.backgroundColor = 'gold';
                        info.pillEl.style.opacity = '1';
                        container.appendChild(info.pillEl);
                    } else {
                        info.pillEl.style.opacity = '0';
                        setTimeout(() => {
                            if (recentAdmins.has(admin)) {
                                info.pillEl.remove();
                                recentAdmins.delete(admin);
                            }
                        }, 1000);
                    }
                }
            });
        }



        function initWebSocket(adminName) {
            myAdminName = adminName
            ws = new WebSocket(`wss://admin-tracker.xnite7.workers.dev?adminName=${encodeURIComponent(adminName)}`);

            ws.onopen = () => { backoff = 1000; };

            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                if (data.type === "adminList") {
                    updateAdminOnline(data.admins);
                }
            };

            ws.onclose = () => {
                setTimeout(() => initWebSocket(adminName), backoff);
                backoff = Math.min(backoff * 2, 30000);
            };

            ws.onerror = (error) => console.error(error);
        }


        function showWelcome(name) {
            target = null
            arrowoff = true
            initWebSocket(name);
            const overlay = document.getElementById('login-overlay');
            const userDiv = document.getElementById('welcome-label');
            const text = `Welcome, ${name}.`;
            userDiv.textContent = "";
            let i = 0;
            const length = text.length * 80

            overlay.style.background = 'transparent';
            overlay.style.pointerEvents = 'none';
            overlay.style.position = 'absolute';
            overlay.style.zIndex = '9999'

            if (document.querySelector('.garagedoorclosed')) {
                document.querySelector('.garagedoorclosed').remove()
            }
            if (document.querySelector('.garagedoor')) {
                document.querySelector('.garagedoor').remove()
            }
            // fade in with blur first
            setTimeout(() => {
                userDiv.style.opacity = '1';
            }, 100);

            setTimeout(() => {
                // typing effect
                let currentTyper;
                const typeNextChar = () => {
                    // Define timing table for each character type
                    const msTable = {
                        ' ': 50,  // Space - quick
                        ',': 200, // Comma - longer pause 
                        default: Math.floor(Math.random() * 10) + 35// Default typing speed
                    };

                    if (i < text.length) {
                        const char = text.charAt(i);
                        userDiv.textContent += char;
                        i++;
                        // Get delay for next character
                        const delay = msTable[char] || msTable.default;
                        // Clear previous interval and set new one
                        clearInterval(currentTyper);
                        currentTyper = setInterval(typeNextChar, delay);
                    } else {
                        clearInterval(currentTyper);
                        //welcomeTxt.style.borderRight = "none"; // stop cursor
                    }
                };

                currentTyper = setInterval(typeNextChar, 40); // Start with default typing speed
            }, 300);

            // then unblur into focus
            setTimeout(() => {

                userDiv.style.filter = 'blur(0px) drop-shadow(0 0 6px rgba(255,255,255,0.6))';
            }, 100);

            // fade out later
            setTimeout(() => {
                document.querySelector('.login-card').classList.add('bobble');
                document.querySelector('.login-card').style.opacity = '0';
            }, length);
            // continue app logic
            setTimeout(() => {

                overlay.remove()
            }, length + 10000);
        }



        let gamenightOnly = false;
        // --- Admin keys (kept from original) ---
        const adminKeys = {
            '00cc75b3c354bd864d646cc1a790268c33916bd2a32b78b502151640596f7702': 'xnite',
            'd8d8c58d2c8c173f8de0ff61081d77210367d00eabcc76a04cf3d2d5b1cb3ab4': 'harvestmoon',
            '0fc6b5fe21bb973ec350831217401b643eee63a6c29c74fb4fe6606b28ba7f8b': 'ivan',
            '499b66dcc2946daa0c2ff49b05902dd1152d1a21208ca42fc2c9eb23281cb623': 'bagel',
            'b7a6aa6f564e2e8617ea4e3d443c781d5f890377a584b8d46491d2bcc33e5f36': 'wavetechnic'
        };

        async function computeHash(key) {
            const enc = new TextEncoder();
            const data = enc.encode(key);
            const h = await crypto.subtle.digest('SHA-256', data);
            return Array.from(new Uint8Array(h)).map(b => b.toString(16).padStart(2, '0')).join('');
        }

        function getCookie(n) { const v = '; ' + document.cookie; const p = v.split('; ' + n + '='); return p.length === 2 ? p.pop().split(';').shift() : '' }
        function setCookie(n, v, d) { const date = new Date(); date.setTime(date.getTime() + (d * 24 * 60 * 60 * 1000)); document.cookie = n + '=' + v + '; expires=' + date.toUTCString() + '; path=/'; }
        function clearCookie(n) { document.cookie = n + '=; Max-Age=0; path=/'; }

        // UI refs
        const settingsBtn = document.getElementById('settings-btn');
        const settingsMenu = document.getElementById('settings-menu');
        const themeSelect = document.getElementById('theme-select');
        const downloadJson = document.getElementById('download-json');
        const logoutBtn = document.getElementById('logout');
        const adminOnline = document.getElementById('admin-online');

        settingsBtn.onclick = () => { settingsMenu.classList.toggle('show') };
        themeSelect.onchange = document.body.setAttribute('data-theme', themeSelect.value);
        downloadJson.onclick = () => { const b = new Blob([JSON.stringify(jsData, null, 2)], { type: 'application/json' }); const u = URL.createObjectURL(b); const a = document.createElement('a'); a.href = u; a.download = 'auto.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(u); };
        logoutBtn.onclick = () => { clearCookie('adminKey'); location.reload(); };

        // Data holders
        let jsData = {};
        let allItems = [];

        let CURRENT_GIST_VERSION = 0;
        let CURRENT_VERSION = 0;

        // Pagination
        let filteredItems = [];
        let currentPage = 1;



        var dragImgEl = document.createElement('span');
        dragImgEl.setAttribute('style', 'position: absolute; display: block; top: 0; left: 0; width: 0; height: 0;');
        document.body.appendChild(dragImgEl);

        // --- Prompt admin key (same logic) ---
        async function promptAdminKey() {


            const saved = getCookie('adminKey');
            if (saved) {
                const h = await computeHash(saved);
                if (adminKeys[h]) {
                    restoreContent(() => showWelcome(adminKeys[h]));
                    return;
                }
            }

            const overlay = document.getElementById('login-overlay');
            const input = document.getElementById('admin-key');
            const loginBtn = document.getElementById('login-btn');
            const errorDiv = document.getElementById('login-error');
            const userDiv = document.getElementById('welcome-label');
            let tries = 0;


            async function tryLogin() {
                const entered = input.value.trim();
                if (!entered) {
                    errorDiv.textContent = 'Please enter an admin key';
                    return;
                }

                const hash = await computeHash(entered);
                if (adminKeys[hash]) {
                    setCookie('adminKey', entered, 30);

                    restoreContent(() => showWelcome(adminKeys[hash]));
                } else {
                    tries++;
                    if (tries > 4) {
                        errorDiv.textContent = 'Too many attempts. Please refresh.';
                        document.querySelector('.garagedoor').classList.add('garagedoorclosed')
                        input.disabled = true;
                        loginBtn.disabled = true;
                        loginBtn.style.background = 'linear-gradient(180deg, rgb(133 133 133), rgb(73 73 73))';
                        loginBtn.style.border = '1px solid rgb(103 103 103)';
                        return;
                    }

                    errorDiv.textContent = 'Invalid admin key';

                    document.querySelector('.login-card').classList.add('shake');
                    setTimeout(() => {
                        document.querySelector('.login-card').classList.remove('shake');
                    }, 500);
                }
            }
            loginBtn.onclick = tryLogin;

            input.onkeydown = e => {
                if (e.key === 'Enter') tryLogin();
            };

            input.oninput = () => {
                errorDiv.textContent = '';
            };
        }

        // Add this function to restore content and functions
        function restoreContent(callback) {
            // Restore page content



            // Clear stored content for security
            document.querySelector('.login-card').classList.add('glass')


            setTimeout(() => {
                (async function init() {
                    try {
                        const [versionRes, gistRes] = await Promise.all([
                            fetch("https://emwiki.site/api/latest-version", { cache: "no-store" }),
                            fetch("https://emwiki.site/api/gist-version", { cache: "no-store" })
                        ]);

                        const data = await gistRes.json();
                        const raw = data.files?.['auto.json']?.content;
                        jsData = raw ? JSON.parse(raw) : {};
                        allItems = Object.values(jsData).flat();

                        // Add category options to select
                        const sel = document.getElementById('category-filter');
                        const keys = Object.keys(jsData);
                        keys.forEach(k => sel.appendChild(new Option(k.charAt(0).toUpperCase() + k.slice(1), k)));

                        if (versionRes.ok) {
                            const text = await versionRes.text();
                            const [, v] = text.split("|");
                            CURRENT_VERSION = v || "";
                        }

                        CURRENT_GIST_VERSION = data.history?.[0]?.version || "";

                        if (CURRENT_GIST_VERSION !== CURRENT_VERSION) {
                            console.warn("âš ï¸ Version incompatible, Please Refresh.");
                        }

                    } catch (e) { console.error(e); alert('Failed to load data'); }
                    all()
                })();

            }, 10);


            if (document.querySelector('.garagedoorclosed')) {
                document.querySelector('.garagedoorclosed').remove()
            }
            if (document.querySelector('.garagedoor')) {
                document.querySelector('.garagedoor').remove()
            }
            // Execute callback (like showWelcome)
            setTimeout(() => {
                if (callback) callback();
            }, 1500);
        }

        promptAdminKey()



        function all() {

            async function checkUpdate() {
                try {
                    const res = await fetch("https://emwiki.site/api/latest-version", { cache: "no-store" });

                    if (!res.ok) return;

                    const text = await res.text();

                    if (!text.includes("@") || !text.includes("|")) {
                        console.warn("Unexpected response format:", text);
                        return; // skip instead of crashing
                    }

                    const [user, textuah] = text.split("@");
                    const [timestamp, d1Version] = textuah.split("|");

                    if (CURRENT_VERSION !== d1Version) {
                        alert(`âš ï¸ New update to Catalog Detected by ${user.slice(0, -1)}`);
                        location.reload(true);
                    }
                } catch (err) {
                    console.error(`Connection lost: ${err}`);
                }
            }

            setInterval(checkUpdate, 10000);



            // --- Save to Gist endpoint ---
            document.getElementById('save-btn').addEventListener('click', async () => {
                const btn = document.getElementById('save-btn');
                btn.disabled = true;
                btn.textContent = 'Publish...';
                try {
                    const saved = getCookie('adminKey');
                    let adminName = 'Unknown';
                    if (saved) {
                        const h = await computeHash(saved);
                        adminName = adminKeys[h] || adminName;
                    }
                    const res = await fetch('https://emwiki.site/api/update-gist',
                        {
                            method: 'POST', headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ content: jsData, username: adminName, version: '' })
                        });
                    if (res.status === 409) {
                        alert('Conflict detected â€” a newer version exists. Consider downloading and merging.');
                        btn.disabled = false;
                        btn.innerHTML = '<b>âœ”</b> Publish';
                        return;
                    }
                    if (!res.ok) throw new Error('save failed');
                    alert('Saved successfully');
                    location.reload();
                } catch (err) { alert('Save error: ' + err.message); btn.disabled = false; btn.innerHTML = '<b>âœ”</b> Publish'; }
            });

            const saveBtn = document.getElementById('save-btn');

            async function handleSave() {
                if (saveBtn.disabled) return;

                // Disable during request
                saveBtn.disabled = true;
                saveBtn.style.background = "orange";
                saveBtn.style.cursor = "wait";
                saveBtn.textContent = "ðŸ•";

                if (saveBtn.textContent === "â¬‡") {
                    const blob = new Blob([JSON.stringify(jsData, null, 2)], { type: "application/json" });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement("a");
                    a.href = url;
                    a.download = "send_to_xnite.json";
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    return;
                }

                try {
                    const savedKey = getCookie('adminKey');
                    let adminName = "Unknown";
                    if (savedKey) {
                        const hash = await computeHash(savedKey);
                        adminName = adminKeys[hash] || "Unknown";
                    }

                    const response = await fetch("https://emwiki.site/api/update-gist", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            content: jsData,
                            username: adminName,
                            version: CURRENT_GIST_VERSION
                        })
                    });
                    // Restore button first
                    saveBtn.disabled = false;
                    saveBtn.style.background = "#377bfa";
                    saveBtn.style.cursor = "pointer";
                    saveBtn.textContent = "âœ”";

                    if (response.status === 409) {
                        showConflictUI(await response.json());
                        saveBtn.style.transform = "translateY(0px)";
                        saveBtn.style.opacity = "1";
                        saveBtn.textContent = "â¬‡";
                        saveBtn.disabled = false;
                        saveBtn.style.background = "#377bfa";
                        saveBtn.style.cursor = "pointer";
                        return;
                    }

                    if (response.ok) {
                        alert("âœ… Changes saved successfully.");
                        location.reload(true);
                    } else {
                        alert("âŒ Failed to save changes.");
                    }

                } catch (err) {
                    // Restore state on error
                    saveBtn.style.transform = "translateY(0px)";
                    saveBtn.style.opacity = "1";
                    saveBtn.textContent = "â¬‡";
                    saveBtn.disabled = false;
                    saveBtn.style.background = "#377bfa";
                    saveBtn.style.cursor = "pointer";
                    alert("âš ï¸ Error saving changes: " + err.message);
                }
            }

            saveBtn.onclick = handleSave
            function showConflictUI(conflict) {
                const blocker = document.createElement("div");
                blocker.id = "conflict-blocker";
                blocker.style = "position:fixed;inset:0;background:#111;color:white;z-index:9999;padding:40px;font-family:monospace;overflow:auto";
                blocker.innerHTML = `
                    <h2>âš ï¸ Conflict Detected</h2>
                    <p>The Gist has been updated by someone else or is out of sync with D1.</p>
                    <pre style="white-space:pre-wrap;background:#222;padding:10px;border-radius:8px">${conflict.latestDiff || "(No visible changes)"}</pre>
                    <button id="force-save" style="margin-top:20px;background:#e84118;color:white;padding:10px 20px;font-size:16px">Force Save Anyway</button>
                    <button onclick="location.reload()" style="margin-top:20px;margin-left:10px;">Cancel</button>
                `;
                document.body.appendChild(blocker);

                document.getElementById("force-save").onclick = async () => {
                    blocker.innerHTML = "<p>â³ Forcing save...</p>";

                    const savedKey = getCookie('adminKey');
                    let adminName = "Unknown";
                    if (savedKey) {
                        const hash = await computeHash(savedKey);
                        adminName = adminKeys[hash] || "Unknown";
                    }

                    const response = await fetch("https://emwiki.site/api/update-gist", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            content: jsData,
                            username: adminName,
                            version: CURRENT_GIST_VERSION,
                            force: true // ðŸ‘ˆ this skips the conflict check on the backend
                        })
                    });

                    if (response.ok) {
                        location.reload(true);
                    } else {
                        blocker.innerHTML = `<p>âŒ Failed to force save. <button onclick="location.reload()">Retry</button></p>`;
                    }
                };
            }


            target = null
            const input = document.getElementById('quick-editor-price');
            const priceArea = document.querySelector('.price-tag');
            let priceson = true;

            document.getElementById('toggle-prices').onclick = function () {
                const priceTags = document.querySelectorAll('.price-label');
                priceson = !priceson;
                if (!priceson) {
                    document.getElementById('toggle-prices').classList.add('ghost');
                    priceTags.forEach(tag => {
                        tag.classList.add('hidden');
                    });
                } else {
                    document.getElementById('toggle-prices').classList.remove('ghost');
                    priceTags.forEach(tag => {
                        tag.classList.remove('hidden');
                    });
                }
            };
            const quickEditorPrice = document.getElementById('quick-editor-price');

            //on clicked outside quickeditorprice unfocus
            document.addEventListener('click', (e) => {
                if (!quickEditorPrice.contains(e.target)) {
                    quickEditorPrice.parentElement.classList.add('blur');
                }
            });
            quickEditorPrice.parentElement.addEventListener('animationend', () => {
                quickEditorPrice.parentElement.classList.remove('blur');
                quickEditorPrice.blur();
            });

            function findItemType(item) { for (const k in jsData) if (jsData[k].includes(item)) return k; return 'unknown'; }

            function makeItemCard(item) {
                const el = document.createElement('div'); el.className = 'item-card'; el.dataset.name = item.name;
                const img = document.createElement('img'); img.src = item.img || './imgs/trs.png'; img.alt = item.name; img.onerror = () => img.style.display = 'none';
                const name = document.createElement('div'); name.className = 'item-name'; name.textContent = item.name;
                el.appendChild(img); el.appendChild(name);

                if (img.src.includes('trs.png')) {
                    el.style.justifyContent = 'center';
                }
                item.new ? el.style.zIndex = 0 : null

                // editable inputs: price, code, rarity
                const inputs = document.createElement('div'); inputs.style.width = '100%'; inputs.className = 'inputs-row';

                const priceIn = document.createElement('label'); priceIn.className = 'price-label'; priceIn.textContent = shortenThousands(item.price) || '';
                inputs.appendChild(priceIn);
                if (item.price <= 0 || item.price == 'N/A') {
                    priceIn.style.display = 'none';
                }

                function shortenThousands(text) {
                    text = String(text); // Force to string
                    return text.replace(/\b\d{4,}\b/g, match => {
                        const num = parseInt(match, 10);
                        if (num >= 1000) {
                            return (num / 1000).toString().replace(/\.0$/, '') + 'k';
                        }
                        return match;
                    });
                }

                el.appendChild(inputs);

                requestAnimationFrame(() => {
                    name.style.fontSize = "13px";
                    let fontsize = parseInt(window.getComputedStyle(name).fontSize, 10);

                    while (name.offsetWidth > el.offsetWidth - 18 && fontsize > 8) {
                        fontsize -= 1;
                        name.style.fontSize = `${fontsize}px`;
                    }
                });

                // click to open quick editor
                el.addEventListener('click', (e) => {
                    e.preventDefault();
                    // Add scale animation
                    el.style.transition = 'all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1)';
                    el.style.transform = 'scale(0.9)';
                    el.style.filter = 'opacity(0.5)'
                    //el.classList.add('pulse')

                    // Reset scale after animation
                    setTimeout(() => {
                        el.style.transform = '';
                        el.style.filter = ''
                        //el.classList.remove('pulse')
                        // Remove transition after animation completes
                        setTimeout(() => {
                            el.style.transition = '';
                        }, 200);
                    }, 200);
                    openQuickEditor(item);

                });

                return el;
            }

            function renderListPanels() {
                const weeklyEl = document.getElementById('weekly-items'); const starEl = document.getElementById('weeklystar-items');
                weeklyEl.innerHTML = ''; starEl.innerHTML = '';
                for (const k in jsData) { jsData[k].forEach(i => { if (i.weekly) weeklyEl.appendChild(makeItemCard(i)); if (i.weeklystar) starEl.appendChild(makeItemCard(i)); }) }
            }

            let resizeTimer;
            // Re-render on resize
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimer);
                const allEl = document.getElementById('all-items');

                updateCanvasSize()
                resizePanel()

                const containerWidth = allEl.clientWidth;

                const itemMinWidth = 132; // minimum width per item
                const gap = 12; // gap in px

                // Calculate how many items fit per row
                const columns = Math.floor((containerWidth + gap) / (itemMinWidth + gap));
                allEl.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;

                const rows = 2; // or dynamically calculate if you have fixed height

                if (ITEMS_PER_PAGE != columns * rows) renderAll(true);
            });


            document.getElementById('prev-btn').addEventListener('click', () => {
                if (currentPage > 1) { currentPage--; renderAll(true, true); }
            });
            document.getElementById('next-btn').addEventListener('click', () => {
                const totalPages = Math.max(1, Math.ceil(filteredItems.length / ITEMS_PER_PAGE));
                if (currentPage < totalPages) { currentPage++; renderAll(true, true); }
            });

            document.getElementById('search').addEventListener('input', () => {

                renderAll();
            });
            let ITEMS_PER_PAGE = 0;


            function renderAll(keepPage, bottomonly) {
                const allEl = document.getElementById('all-items');

                if (!keepPage) currentPage = 1;


                allEl.innerHTML = '';



                const containerWidth = allEl.clientWidth;

                const itemMinWidth = 132; // minimum width per item
                const gap = 12; // gap in px

                // Calculate how many items fit per row
                const columns = Math.floor((containerWidth + gap) / (itemMinWidth + gap));
                allEl.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;

                const rows = 2; // or dynamically calculate if you have fixed height

                ITEMS_PER_PAGE = columns * rows;

                const start = (currentPage - 1) * ITEMS_PER_PAGE;




                if (!bottomonly) {
                    // First handle weekly/star panels
                    const weeklyEl = document.getElementById('weekly-items');
                    const starEl = document.getElementById('weeklystar-items');
                    weeklyEl.innerHTML = '';
                    starEl.innerHTML = '';
                    allItems.forEach(item => {
                        if (item.weekly) weeklyEl.appendChild(makeItemCard(item));
                        if (item.weeklystar) starEl.appendChild(makeItemCard(item));
                    });
                }


                // Start with all items
                let filtered = allItems.slice();

                // Apply category filter first
                const selectedCategory = document.getElementById('category-filter').value;
                if (selectedCategory !== 'all') {
                    filtered = jsData[selectedCategory] ? jsData[selectedCategory].slice() : [];
                }

                // Apply gamenight filter
                if (gamenightOnly) {
                    filtered = filtered.filter(i => (i.from && i.from.toLowerCase().includes("gamenight")));
                }

                // Apply search filter
                const searchQuery = document.getElementById('search').value.trim();
                if (searchQuery) {
                    // Create new Fuse instance with currently filtered items
                    const tempFuse = new Fuse(filtered, {
                        keys: ['name'],
                        threshold: 0.35
                    });
                    filtered = tempFuse.search(searchQuery).map(r => r.item);
                }

                // Apply sorting
                const sort = document.getElementById('sort-select').value;
                if (sort === 'az') filtered.sort((a, b) => a.name.localeCompare(b.name));
                else if (sort === 'za') filtered.sort((a, b) => b.name.localeCompare(a.name));
                else if (sort === 'high') filtered.sort((a, b) => (parseInt(b.price || 0) || 0) - (parseInt(a.price || 0) || 0));
                else if (sort === 'low') filtered.sort((a, b) => (parseInt(a.price || 0) || 0) - (parseInt(b.price || 0) || 0));

                // Update filteredItems for pagination
                filteredItems = filtered;

                // Render current page
                filtered.slice((currentPage - 1) * ITEMS_PER_PAGE, currentPage * ITEMS_PER_PAGE)
                    .forEach(item => allEl.appendChild(makeItemCard(item)));

                // Update pagination
                const totalPages = Math.max(1, Math.ceil(filtered.length / ITEMS_PER_PAGE));
                document.getElementById('page-count').textContent = `Page ${currentPage} of ${totalPages}`;

                // Update pagination buttons
                const prevBtn = document.getElementById('prev-btn');
                const nextBtn = document.getElementById('next-btn');
                prevBtn.disabled = currentPage === 1;
                nextBtn.disabled = currentPage === totalPages;
                prevBtn.style.opacity = currentPage === 1 ? '0.5' : '1';
                nextBtn.style.opacity = currentPage === totalPages ? '0.5' : '1';
            }
            renderAll()

            /* ========== EVENTS ========== */
            document.getElementById('gamenight-toggle').addEventListener('click', () => {
                gamenightOnly = !gamenightOnly;
                if (!gamenightOnly) {
                    document.getElementById('gamenight-toggle').classList.add('ghost');
                } else {
                    document.getElementById('gamenight-toggle').classList.remove('ghost');
                }
                renderAll();
            });

            // --- History ---
            async function loadHistory() {
                const el = document.getElementById('history-list'); el.innerHTML = 'Loading...';
                try {
                    //only get top 6 and put a load more button by slicing the array
                    const res = await fetch('https://emwiki.site/api/history');
                    if (!res.ok) throw new Error('history fetch failed');
                    const data = await res.json();
                    if (!Array.isArray(data) || data.length === 0) {
                        el.innerHTML = '<p>No history available.</p>';
                        return;
                    }
                    el.innerHTML = '';

                    let currentIndex = 0; // track the next item to render
                    const batchSize = 3;  // render 4 items at a time

                    function renderHistoryItem(e) {
                        // Header: username + time
                        const header = document.createElement('div');
                        header.style.cssText = 'background: linear-gradient(rgb(34 34 34), rgb(8 8 8));padding: 7px;border-radius: 6px;margin-bottom: 1.2rem; font-weight:700; font-size:19px; margin-bottom:4px; display:flex; justify-content: space-between; align-items: baseline;';
                        header.textContent = e.username;
                        const timeDiv = document.createElement('div');
                        timeDiv.style.cssText = 'font-weight:900; font-size:14px; color:#666;';
                        const ts = new Date(e.timestamp);

                        const now = new Date();

                        const isToday = ts.toDateString() === now.toDateString();
                        const yesterday = new Date();
                        yesterday.setDate(now.getDate() - 1);
                        const isYesterday = ts.toDateString() === yesterday.toDateString();

                        let hours = ts.getHours();
                        const minutes = ts.getMinutes().toString().padStart(2, '0');
                        const seconds = ts.getSeconds().toString().padStart(2, '0');
                        const ampm = hours >= 12 ? 'PM' : 'AM';
                        hours = hours % 12;
                        if (hours === 0) hours = 12;

                        const formattedTime = `${hours}:${minutes}:${seconds} ${ampm}`;

                        let timeLabel = '';
                        if (isToday) {
                            timeLabel = `Today, ${formattedTime}`;
                        } else if (isYesterday) {
                            timeLabel = `Yesterday, ${formattedTime}`;
                        } else {
                            timeLabel = ts.toLocaleString();
                        }

                        timeDiv.textContent = timeLabel;

                        header.appendChild(timeDiv);



                        // Diff container
                        const h = document.createElement('div');
                        h.className = 'history-item';

                        h.appendChild(header);

                        const lines = e.diff?.split('\n') || [];
                        const changes = { weeklystar: [], weekly: [], new: [], price: [], from: [], retired: [], premium: [], tradable: [] };
                        for (const line of lines) {

                            const m = line.match(/^\[(.+?)\] (\w+): (.*) â†’ (.*)$/);
                            if (!m) continue;
                            const [, item, fieldRaw, oldRaw, newRaw] = m;
                            const field = fieldRaw.toLowerCase();
                            const oldVal = oldRaw === 'undefined' || oldRaw === '' ? undefined : oldRaw;
                            const newVal = newRaw === 'undefined' || newRaw === '' ? undefined : newRaw;


                            if (['weeklystar', 'weekly', 'new', 'retired', 'premium', 'tradable'].includes(field)) {
                                if (newVal === 'true' || newVal === 'false') {
                                    changes[field].push({ item, value: newVal === 'true' });
                                }
                            } else if (field === 'price') {
                                const parsePrice = v => (!v || v === 'undefined' ? "0" : v);
                                changes.price.push({
                                    item,
                                    oldPrice: parsePrice(oldRaw),
                                    newPrice: parsePrice(newRaw)
                                });
                            } else if (field === 'from') {
                                changes.from.push({ item, oldDesc: oldVal, newDesc: newVal });
                            }
                        }

                        function createSection(title, items, format) {

                            if (!items.length) return null;
                            const sec = document.createElement('div');
                            const h4 = document.createElement('h4');
                            h4.textContent = title;
                            h4.style.margin = '8px 0 4px 0';
                            h4.style.fontWeight = '600';
                            h4.style.fontSize = '21px';
                            h4.style.color = '#9f9790';
                            h4.style.fontVariant = 'all-petite-caps';
                            sec.appendChild(h4);
                            sec.style.marginLeft = '18px';

                            const ul2 = document.createElement('ul');
                            ul2.style.cssText = 'margin:0 0 8px 16px; padding:0; list-style:none; font-size:14px; color:#ddd;';
                            for (const i of items) {
                                const li2 = document.createElement('li');
                                li2.style.marginBottom = '3px';
                                if (title == 'Description:') {

                                    li2.style.marginBottom = '16px';
                                }

                                li2.innerHTML = format(i);
                                ul2.appendChild(li2);
                            }

                            sec.appendChild(ul2);
                            return sec;
                        }

                        const sections = [
                            ['Star shop:', changes.weeklystar, i => `${i.value ? '<span style="display:inline-block;width:1.2em;text-align:center;color:#6f6">âœ”</span>' : '<span style="display:inline-block;width:1.2em;text-align:center;color:#f66">ðŸ—™</span>'} <strong>[${i.item}]</strong> `],
                            ['Weekly:', changes.weekly, i => `${i.value ? '<span style="display:inline-block;width:1.2em;text-align:center;color:#6f6">âœ”</span>' : '<span style="display:inline-block;width:1.2em;text-align:center;color:#f66">ðŸ—™</span>'} <strong>[${i.item}]</strong>`],
                            ['New:', changes.new, i => `${i.value ? '<span style="display:inline-block;width:1.2em;text-align:center;color:#6f6">âœ”</span>' : '<span style="display:inline-block;width:1.2em;text-align:center;color:#f66">ðŸ—™</span>'} <strong>[${i.item}]</strong> `],
                            ['Retired:', changes.retired, i => `${i.value ? '<span style="display:inline-block;width:1.2em;text-align:center;color:#6f6">âœ”</span>' : '<span style="display:inline-block;width:1.2em;text-align:center;color:#f66">ðŸ—™</span>'} <strong>[${i.item}]</strong> `],
                            ['Premium:', changes.premium, i => `${i.value ? '<span style="display:inline-block;width:1.2em;text-align:center;color:#6f6">âœ”</span>' : '<span style="display:inline-block;width:1.2em;text-align:center;color:#f66">ðŸ—™</span>'} <strong>[${i.item}]</strong> `],
                            ['Tradable:', changes.tradable, i => `${i.value ? '<span style="display:inline-block;width:1.2em;text-align:center;color:#6f6">âœ”</span>' : '<span style="display:inline-block;width:1.2em;text-align:center;color:#f66">ðŸ—™</span>'} <strong>[${i.item}]</strong> `],
                            ['Price:', changes.price, i => `<span style="display:inline-block;width:1.2em;text-align:center;color:#fa4;font-weight:bolder;">$</span> <strong>[${i.item}]</strong> <span style="color:#f66">${i.oldPrice}</span> â†’ <span style="color:#6f6">${i.newPrice}</span>`],
                            ['Description:', changes.from, i => {
                                // split into lines

                                const oldLines = (i.oldDesc || "").split(/<br>|\n/).map(s => s.trim()).filter(Boolean);
                                const newLines = (i.newDesc || "").split(/<br>|\n/).map(s => s.trim()).filter(Boolean);

                                // zip longest length
                                const max = Math.max(oldLines.length, newLines.length);
                                let out = `<strong>[${i.item}]</strong><br>`;
                                for (let j = 0; j < max; j++) {
                                    const oldL = oldLines[j];
                                    const newL = newLines[j];
                                    if (oldL === newL) {
                                        out += `&nbsp;&nbsp;â¨½&nbsp;${oldL}<br>`;
                                    } else if (oldL && newL) {
                                        out += `&nbsp;&nbsp;â¨½&nbsp;<span style="color:#fa4">${oldL}</span> â†’ <span style="color:#fa4">${newL}</span><br>`;
                                    } else if (oldL && !newL) {
                                        out += `&nbsp;&nbsp;â¨½&nbsp;<span style="color:#f66">${oldL} ðŸ—™</span><br>`;
                                    } else if (!oldL && newL) {
                                        out += `&nbsp;&nbsp;â¨½&nbsp;<span style="color:#6f6">${newL} +</span><br>`;
                                    }
                                }
                                return out;
                            }],

                        ];

                        let anySectionAdded = false;
                        for (const [title, items, fmt] of sections) {

                            const sectionEl = createSection(title, items, fmt);
                            if (sectionEl) {
                                h.appendChild(sectionEl);
                                anySectionAdded = true;
                            }
                        }

                        if (!anySectionAdded) {
                            h.textContent = e.diff || '(no diff available)';
                        }

                        el.appendChild(h);
                    }

                    function renderNextBatch() {
                        const slice = data.slice(currentIndex, currentIndex + batchSize);
                        slice.forEach(renderHistoryItem);
                        currentIndex += batchSize;

                        // Remove existing load more button
                        const existingBtn = el.querySelector('.load-more-btn');
                        if (existingBtn) existingBtn.remove();

                        // Add button if more entries remain
                        if (currentIndex < data.length) {
                            const loadMoreBtn = document.createElement('button');
                            loadMoreBtn.textContent = 'Load more history';
                            loadMoreBtn.className = 'small-btn ghost load-more-btn';
                            loadMoreBtn.style.marginTop = '8px';
                            loadMoreBtn.onclick = renderNextBatch;
                            el.appendChild(loadMoreBtn);
                        }
                    }

                    renderNextBatch();

                } catch (err) {
                    el.innerHTML = 'Failed to load history: ' + err.message
                    console.error(err);
                }
            }


            // --- Drag & drop with Sortable (clone from original) ---
            function setupDragDrop() {
                const FLAG_PANELS = { 'weekly-items': 'weekly', 'weeklystar-items': 'weeklystar' };

                // master list
                new Sortable(document.getElementById('all-items'), {
                    group: { name: 'shared-flags', pull: 'clone', put: false },
                    animation: 150,
                    sort: false,
                    onStart: evt => { evt.item.style.opacity = '0.25'; },
                    onEnd: evt => { evt.item.style.opacity = ''; }
                });

                // helper to check duplicates
                function alreadyInList(toEl, dragEl) {
                    const name = dragEl.dataset.name;
                    
                    return Array.from(toEl.children).some(el => el.dataset.name === name);
                }

                Object.entries(FLAG_PANELS).forEach(([id, key]) => {
                    new Sortable(document.getElementById(id), {
                        group: {
                            name: 'shared-flags',
                            pull: 'clone',
                            put: (to, from, dragEl) => {
                                // prevent if already exists in this list
                                return !alreadyInList(to.el, dragEl);
                            }
                        },
                        animation: 150,
                        sort: false,
                        onAdd(evt) {
                            const name = evt.item.dataset.name;
                            for (const arr of Object.values(jsData)) {
                                const it = arr.find(x => x.name === name);
                                if (it) { it[key] = true; }
                                if (it === currentEditingItem) { openQuickEditor(it); }

                            }

                            renderAll(true);
                        },
                        onStart: evt => { evt.item.style.opacity = '0.25'; },
                        onEnd: evt => { evt.item.style.opacity = ''; }
                    });
                });
            }

            // --- Helpers ---
            let currentEditingItem = null;


            function openQuickEditor(item) {
                currentEditingItem = item;
                const modal = document.getElementById('quick-editor-modal');
                const RAP = document.getElementById('quick-editor-price')
                document.getElementById('quick-editor-content').classList.remove('initial');
                document.getElementById('quick-editor-title').textContent = item.name;
                const imgEl = document.getElementById('quick-editor-img');
                if (item.img) {
                    imgEl.src = item.img;
                    imgEl.style.display = 'block';
                } else {
                    imgEl.style.display = 'none';
                }
                RAP.placeholder = "RAP";
                RAP.value = item.price || '';

                RAP.onchange = () => {
                    currentEditingItem.price = RAP.value.trim();
                    renderAll(true)
                };

                const desccontainer = document.querySelector('.desc-list');
                desccontainer.innerHTML = '';
                const prccontainer = document.querySelector('.prc-list');
                prccontainer.innerHTML = '';


                const TAG_COLORS = { New: "#1abc9c", Weekly: "#3498db", Star: "#f1c40f", Retired: "#9b59b6", Premium: "#e67e22", Untradable: "#e74c3c" };
                let tags = Object.entries({ New: item.new, Weekly: item.weekly, Star: item.weeklystar, Retired: item.retired, Premium: item.premium, Untradable: !item.tradable })
                    .filter(([k, v]) => v).map(([k]) => k);

                const flagRow = document.querySelector('.flag-row'), modalContent = document.getElementById('quick-editor-content');
                let tagMenu = null;

                const tagToProp = {
                    New: "new",
                    Weekly: "weekly",
                    Star: "weeklystar",
                    Retired: "retired",
                    Premium: "premium",
                    Untradable: "tradable"
                };

                const renderTags = () => {
                    flagRow.querySelectorAll('.tag-pill').forEach(e => e.remove());
                    tags.forEach(tag => {
                        const el = document.createElement('span');
                        Object.assign(el, { className: 'tag-pill', textContent: tag, style: `border-color:${TAG_COLORS[tag] || '#aaa'};background:${(TAG_COLORS[tag] || '#aaa')}33;color:${TAG_COLORS[tag] || '#aaa'}` });
                        const x = document.createElement('span'); x.textContent = ' Ã—'; x.style.cursor = 'pointer'; x.style.webkitTextStrokeWidth = 'medium';
                        x.onclick = () => { tags = tags.filter(t => t !== tag); renderTags(); if (tag === "Untradable") { currentEditingItem[tagToProp[tag]] = true; } else { currentEditingItem[tagToProp[tag]] = false; } renderListPanels(); };
                        el.appendChild(x); flagRow.appendChild(el);
                    });
                };

                const openTagSelector = () => {
                    if (tagMenu) tagMenu.remove();
                    tagMenu = document.createElement('div');
                    Object.assign(tagMenu.style, { position: 'absolute', background: '#1e293b', padding: '10px', border: '1px solid #555', borderRadius: '8px', zIndex: 1000 });
                    Object.keys(TAG_COLORS).forEach(tag => {
                        const b = document.createElement('button'); b.textContent = tag; b.className = 'tag-option';
                        if (tags.includes(tag)) Object.assign(b.style, { background: TAG_COLORS[tag] + '36', color: '#5c5c5c' });
                        b.onclick = () => { if (!tags.includes(tag)) tags.push(tag); if (tag === "Untradable") { currentEditingItem[tagToProp[tag]] = false; } else { currentEditingItem[tagToProp[tag]] = true; } tagMenu.remove(); tagMenu = null; renderTags(); renderListPanels(); };
                        tagMenu.appendChild(b);
                    });
                    flagRow.appendChild(tagMenu);
                };

                flagRow.querySelectorAll('.tag-pill,.small-btn.ghost').forEach(e => e.remove());
                renderTags();
                const btn = document.createElement('button'); btn.className = 'small-btn ghost'; btn.textContent = 'Tags'; btn.style.marginTop = '-40px'; btn.style.fontVariant = 'all-petite-caps'; btn.style.position = "absolute"; btn.onclick = e => {
                    e.stopPropagation();
                    openTagSelector();
                };
                flagRow.appendChild(btn);

                // Close tag menu when clicking anywhere else in modal
                modalContent.addEventListener('click', e => {
                    if (tagMenu && !tagMenu.contains(e.target) && !e.target.classList.contains('tag-option') && e.target !== btn) {
                        tagMenu.remove();
                        tagMenu = null;
                    }
                });


                // Add a new input button
                document.getElementById('new-desc-btn').onclick = (e) => {

                    createDesc('');
                };

                document.getElementById('new-gn-btn').onclick = () => {
                    createDesc(`Gamenight (${formattedDate}. ${formattedYear})`, true);
                };

                document.getElementById('new-prc-btn').onclick = () => {
                    createPrc('');
                };

                // flags
                function createDesc(value = '', date = false) {
                    const months = ['Jan.', 'Feb.', 'Mar.', 'Apr.', 'May', 'Jun.', 'Jul.', 'Aug.', 'Sep.', 'Oct.', 'Nov.', 'Dec.']
                    const s = new Set()
                    const li = Object.assign(document.createElement('li'), { className: 'desc-item', style: 'display:flex;align-items:center;gap:6px;flex-wrap:wrap;background:#555;color:#fff;border-radius:6px;padding:5px 11px;margin-bottom:6px;cursor:grab;user-select:none' })
                    const label = Object.assign(document.createElement('span'), { style: 'max-width:255px;flex-grow:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;', textContent: value || 'Description...' })
                    const input = Object.assign(document.createElement('input'), { type: 'text', value: value || '', style: 'flex-grow:1;display:none;border:none;border-radius:4px;padding:6px 8px' })
                    const monthswrapper = Object.assign(document.createElement('div'), { style: 'cursor: initial;justify-content: space-evenly;display:none;flex-wrap:wrap;gap:4px;flex-grow:1' })
                    const yearinput = Object.assign(document.createElement('input'), { min: 2016, max: new Date().getFullYear(), type: 'number', placeholder: 'Year', style: 'font-weight: 700;font-size: 15px;width:50px;display:none;border:none;border-radius:4px;padding:4px 6px' })
                    const editButton = Object.assign(document.createElement('button'), { innerHTML: '<div class="icon" style="mask-image: url(\'data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!--%20License%3A%20PD.%20Made%20by%20mono-company%3A%20https%3A%2F%2Fgithub.com%2Fmono-company%2Fmono-icons%20--%3E%3Csvg%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M16.293%203.293a1%201%200%200%201%201.414%200l3%203a1%201%200%200%201%200%201.414l-9%209A1%201%200%200%201%2011%2017H8a1%201%200%200%201-1-1v-3a1%201%200%200%201%20.293-.707l9-9zM9%2013.414V15h1.586l8-8L17%205.414l-8%208zM3%207a2%202%200%200%201%202-2h5a1%201%200%201%201%200%202H5v12h12v-5a1%201%200%201%201%202%200v5a2%202%200%200%201-2%202H5a2%202%200%200%201-2-2V7z%22%20%2F%3E%3C%2Fsvg%3E\');"></div>á´‡á´…Éªá´›', className: 'small-btn ghost' })
                    const deleteButton = Object.assign(document.createElement('button'), { innerHTML: '<div class="icon" style="mask-image: url(\'data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!--%20License%3A%20PD.%20Made%20by%20mono-company%3A%20https%3A%2F%2Fgithub.com%2Fmono-company%2Fmono-icons%20--%3E%3Csvg%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M7%204a2%202%200%200%201%202-2h6a2%202%200%200%201%202%202v2h4a1%201%200%201%201%200%202h-1.069l-.867%2012.142A2%202%200%200%201%2017.069%2022H6.93a2%202%200%200%201-1.995-1.858L4.07%208H3a1%201%200%200%201%200-2h4V4zm2%202h6V4H9v2zM6.074%208l.857%2012H17.07l.857-12H6.074zM10%2010a1%201%200%200%201%201%201v6a1%201%200%201%201-2%200v-6a1%201%200%200%201%201-1zm4%200a1%201%200%200%201%201%201v6a1%201%200%201%201-2%200v-6a1%201%200%200%201%201-1z%22%20%2F%3E%3C%2Fsvg%3E\');"></div>', style: 'padding: 6px 0px 6px 6px;background:#f66', className: 'small-btn' });
                    const okbutton = Object.assign(document.createElement('button'), { innerHTML: '<div class="icon" style="mask-image: url(\'data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!--%20License%3A%20OFL.%20Made%20by%20govicons%3A%20https%3A%2F%2Fgithub.com%2F540co%2Fgovicons%20--%3E%3Csvg%20viewBox%3D%220%20-8%2072%2072%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M61.07%2C12.9%2C57%2C8.84a2.93%2C2.93%2C0%2C0%2C0-4.21%2C0L28.91%2C32.73%2C19.2%2C23A3%2C3%2C0%2C0%2C0%2C15%2C23l-4.06%2C4.07a2.93%2C2.93%2C0%2C0%2C0%2C0%2C4.21L26.81%2C47.16a2.84%2C2.84%2C0%2C0%2C0%2C2.1.89A2.87%2C2.87%2C0%2C0%2C0%2C31%2C47.16l30.05-30a2.93%2C2.93%2C0%2C0%2C0%2C0-4.21Z%22%2F%3E%3C%2Fsvg%3E\');"></div>', style: 'background: rgb(95 193 95);padding: 6px 0px 6px 6px;text-shadow: 0 0 5px #00000057;display:none;font-weight: 700;', className: 'small-btn' });

                    months.forEach(month => {
                        const button = document.createElement('span');
                        button.textContent = month; button.style.cssText = 'padding:4px 8px;border-radius:4px;background:#777;cursor:pointer;user-select:none;transition:all .15s';
                        button.onclick = () => {
                            (s.has(month) ? s.delete(month) : s.add(month)),
                                button.style.background = s.has(month) ? 'var(--accent)' : '#777';
                            button.style.transform = 'scale(1.05)';
                            setTimeout(() => button.style.transform = '', 100);
                        };
                        monthswrapper.appendChild(button);
                    });

                    if (date) {
                        monthswrapper.append(yearinput, okbutton);
                        li.append(label, input, monthswrapper, editButton, deleteButton);
                    } else {
                        li.append(label, input, yearinput, monthswrapper, editButton, deleteButton, okbutton);
                    }

                    desccontainer.appendChild(li); Sortable.create(desccontainer, { animation: 150, handle: '.desc-item', group: { name: 'desc', pull: false, put: false }, sort: true });

                    li.ondragstart = e => { e.dataTransfer.setData('text/plain', item.name); e.dataTransfer.effectAllowed = 'move'; e.dataTransfer.setDragImage(dragImgEl, 0, 0); li.style.opacity = '0.5'; }
                    li.ondragend = () => { li.style.opacity = '1'; }

                    if (date && /\(.+\)/.test(value)) { let [_, months, year] = value.match(/\((.+)\s(\d{4})\)/) || []; months && months.split(',').map(z => z.trim()).forEach(z => { s.add(z);[...monthswrapper.children].forEach(t => t.textContent == z && (t.style.background = 'var(--accent)')) }); yearinput.value = year || '' }

                    const edit = () => { deleteButton.style.display = 'none'; okbutton.style.display = 'inline-block'; label.style.display = 'none'; editButton.style.display = 'none'; (date ? (monthswrapper.style.display = 'flex', yearinput.style.display = 'inline-block') : (input.style.display = 'inline-block', input.focus())) }

                    const done = () => {
                        deleteButton.style.display = 'inline-block';
                        okbutton.style.display = 'none';
                        value = date ? `Gamenight (${[...s].join(', ')}${yearinput.value ? ' ' + yearinput.value : ''})` : (input.value.trim() || 'Description...');
                        label.textContent = value;
                        label.style.display = 'inline';
                        input.style.display = monthswrapper.style.display = yearinput.style.display = 'none';
                        editButton.style.display = 'inline-block'
                        currentEditingItem.from = Array.from(document.querySelectorAll('.desc-item > span')).map(input => input.textContent.trim()).filter(v => v).join('<br>') || currentEditingItem.from || '';
                    };

                    editButton.onclick = e => { e.stopPropagation(); edit() };
                    label.ondblclick = edit;
                    input.onblur = done;
                    input.onkeydown = e => { if (e.key == 'Enter' || e.key == 'Escape') done() };
                    deleteButton.onclick = () => {
                        li.remove();
                        currentEditingItem.from = Array.from(document.querySelectorAll('.desc-item input'))
                            .map(input => input.value.trim())
                            .filter(v => v)
                            .join('<br>') || '';
                    };
                    okbutton.onclick = () => done();
                    updateWidth()
                }


                function createPrc(value = '') {
                    const s = new Set()
                    const li = Object.assign(document.createElement('li'), { className: 'prc-item', style: 'display:flex;align-items:center;gap:6px;flex-wrap:wrap;background:#555;color:#fff;border-radius:6px;padding:5px 11px;margin-bottom:6px;cursor:grab;user-select:none' })
                    const icon = Object.assign(document.createElement('img'), { src: './imgs/trs.png', style: 'display:inline-block;width: 20px; height: 20px; margin-right: 6px; vertical-align: middle;' })
                    const label = Object.assign(document.createElement('span'), { className: 'prc-label', style: 'max-width:223px;flex-grow:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;', textContent: value || 'Price...' })
                    const input = Object.assign(document.createElement('input'), { type: 'text', value: value || '', style: 'flex-grow:1;display:none;border:none;border-radius:4px;padding:6px 8px' })
                    const editButton = Object.assign(document.createElement('button'), { innerHTML: '<div class="icon" style="mask-image: url(\'data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!--%20License%3A%20PD.%20Made%20by%20mono-company%3A%20https%3A%2F%2Fgithub.com%2Fmono-company%2Fmono-icons%20--%3E%3Csvg%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M16.293%203.293a1%201%200%200%201%201.414%200l3%203a1%201%200%200%201%200%201.414l-9%209A1%201%200%200%201%2011%2017H8a1%201%200%200%201-1-1v-3a1%201%200%200%201%20.293-.707l9-9zM9%2013.414V15h1.586l8-8L17%205.414l-8%208zM3%207a2%202%200%200%201%202-2h5a1%201%200%201%201%200%202H5v12h12v-5a1%201%200%201%201%202%200v5a2%202%200%200%201-2%202H5a2%202%200%200%201-2-2V7z%22%20%2F%3E%3C%2Fsvg%3E\');"></div>á´‡á´…Éªá´›', className: 'small-btn ghost' })
                    const deleteButton = Object.assign(document.createElement('button'), { innerHTML: '<div class="icon" style="mask-image: url(\'data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!--%20License%3A%20PD.%20Made%20by%20mono-company%3A%20https%3A%2F%2Fgithub.com%2Fmono-company%2Fmono-icons%20--%3E%3Csvg%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M7%204a2%202%200%200%201%202-2h6a2%202%200%200%201%202%202v2h4a1%201%200%201%201%200%202h-1.069l-.867%2012.142A2%202%200%200%201%2017.069%2022H6.93a2%202%200%200%201-1.995-1.858L4.07%208H3a1%201%200%200%201%200-2h4V4zm2%202h6V4H9v2zM6.074%208l.857%2012H17.07l.857-12H6.074zM10%2010a1%201%200%200%201%201%201v6a1%201%200%201%201-2%200v-6a1%201%200%200%201%201-1zm4%200a1%201%200%200%201%201%201v6a1%201%200%201%201-2%200v-6a1%201%200%200%201%201-1z%22%20%2F%3E%3C%2Fsvg%3E\');"></div>', style: 'padding: 6px 0px 6px 6px;background:#f66', className: 'small-btn' });
                    const okbutton = Object.assign(document.createElement('button'), { innerHTML: '<div class="icon" style="mask-image: url(\'data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!--%20License%3A%20OFL.%20Made%20by%20govicons%3A%20https%3A%2F%2Fgithub.com%2F540co%2Fgovicons%20--%3E%3Csvg%20viewBox%3D%220%20-8%2072%2072%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M61.07%2C12.9%2C57%2C8.84a2.93%2C2.93%2C0%2C0%2C0-4.21%2C0L28.91%2C32.73%2C19.2%2C23A3%2C3%2C0%2C0%2C0%2C15%2C23l-4.06%2C4.07a2.93%2C2.93%2C0%2C0%2C0%2C0%2C4.21L26.81%2C47.16a2.84%2C2.84%2C0%2C0%2C0%2C2.1.89A2.87%2C2.87%2C0%2C0%2C0%2C31%2C47.16l30.05-30a2.93%2C2.93%2C0%2C0%2C0%2C0-4.21Z%22%2F%3E%3C%2Fsvg%3E\');"></div>', style: 'background: rgb(95 193 95);padding: 6px 0px 6px 6px;text-shadow: 0 0 5px #00000057;display:none;font-weight: 700;', className: 'small-btn' });

                    function formatify() {
                        const text = input.value.trim();

                        icon.style.display = 'inline-block';
                        icon.src = `./imgs/trs.png`;

                        label.style.color = "#fff";
                        label.style.fontWeight = "normal";
                        label.style.textShadow = "";

                        if (text.includes("Tokens")) {
                            Object.assign(label.style, { fontWeight: 500, textStroke: "1px rgb(255, 83, 219)", webkitTextStroke: "1px rgb(255, 83, 219)" });
                        }
                        if (text.includes("Robux")) {
                            Object.assign(label.style, { fontWeight: 700 });
                        }

                        const iconMap = {
                            Robux: "./imgs/cf8ZvY7.png",
                            Coins: "./imgs/Coin.webp",
                            Stars: "./imgs/WKeX5AS.png",
                            Visors: "./imgs/7IoLZCN.png",
                            Pumpkins: "./imgs/bHRBTrU.png",
                            Eggs: "./imgs/qMxjgQy.png",
                            Opals: "./imgs/wwMMAvr.png",
                            Opal: "./imgs/wwMMAvr.png",
                            Baubles: "./imgs/bauble.png",
                            Bauble: "./imgs/bauble.png",
                            Tokens: "./imgs/Cy9r140.png",
                            Token: "./imgs/Cy9r140.png"
                        };

                        for (const [key, src] of Object.entries(iconMap)) {
                            if (text.includes(key)) {
                                label.textContent = text.replace(` ${key}`, "");
                                icon.src = `${src}`;
                                break;
                            }
                        }
                        Object.assign(label.style, { fontFamily: "BuilderSans" });
                        if (text.includes("%")) {
                            label.style.color = "rgb(193 68 255)";
                            label.style.fontWeight = 500;
                            label.style.textShadow = "0 0 6px rgb(199 0 255)";
                        } else if (text.includes("[EXPIRED]")) {
                            Object.assign(label.style, { textShadow: "0 0 10px black", fontSize: "16px", fontVariant: "unicase", fontFamily: "cursive", color: "rgb(255 31 31)" });
                        } else if (text.includes("[ACTIVE]")) {
                            Object.assign(label.style, { fontFamily: "cursive", color: "rgb(251 255 68)" });
                        } else if (text.includes("Unobtainable")) {
                            icon.src = `./imgs/Red_x.png`;
                            label.style.color = "rgb(255 44 44)";
                        }

                        if (icon.src.includes('trs.png')) {

                            icon.style.display = 'none';
                        }
                    }
                    formatify()

                    input.oninput = () => formatify();


                    li.append(icon, label, input, editButton, deleteButton, okbutton);


                    prccontainer.appendChild(li); Sortable.create(prccontainer, { animation: 150, handle: '.prc-item', group: { name: 'desc', pull: false, put: false }, sort: true });

                    li.ondragstart = e => { e.dataTransfer.setData('text/plain', item.name); e.dataTransfer.effectAllowed = 'move'; e.dataTransfer.setDragImage(dragImgEl, 0, 0); li.style.opacity = '0.5'; }
                    li.ondragend = () => { li.style.opacity = '1'; }

                    const edit = () => { deleteButton.style.display = 'none'; okbutton.style.display = 'inline-block'; label.style.display = 'none'; editButton.style.display = 'none'; (input.style.display = 'inline-block', input.focus()) }

                    const done = () => {
                        deleteButton.style.display = 'inline-block';
                        okbutton.style.display = 'none';
                        label.textContent = (input.value.trim() || 'Price...');
                        label.style.display = 'inline';
                        input.style.display = 'none';
                        editButton.style.display = 'inline-block'
                        formatify();


                        currentEditingItem['price/code/rarity'] = Array.from(document.querySelectorAll('.prc-item input')).map(input => input.value.trim()).filter(v => v).join('<br>') || currentEditingItem['price/code/rarity'] || '';
                    };

                    editButton.onclick = e => { e.stopPropagation(); edit() };
                    label.ondblclick = edit; input.onblur = done;
                    input.onkeydown = e => { if (e.key == 'Enter' || e.key == 'Escape') done() };
                    deleteButton.onclick = () => {
                        li.remove();
                        currentEditingItem['price/code/rarity'] = Array.from(document.querySelectorAll('.prc-item input'))
                            .map(input => input.value.trim())
                            .filter(v => v)
                            .join('<br>') || '';
                    };
                    okbutton.onclick = () => done();
                    updateWidth()

                }


                const descriptions = (item.from || '').split('<br>').map(x => x.trim()).filter(Boolean).forEach(v => createDesc(v, /\([A-Z][a-z]{2}\./.test(v)));
                const prc = (item['price/code/rarity'] || '').split('<br>').map(x => x.trim()).filter(Boolean).forEach(v => createPrc(v));



                const now = new Date();
                const month = { month: 'short' };
                const year = { year: 'numeric' };
                const formattedDate = now.toLocaleDateString('en-US', month);
                const formattedYear = now.toLocaleDateString('en-US', year);
                // Show the modal
                modal.classList.add('show');
                modal.classList.remove('hidden');
            }



            document.getElementById('quick-editor-close').addEventListener('click', () => {
                closeQuickEditor();
            });

            function closeQuickEditor() {
                const modal = document.getElementById('quick-editor-modal');
                modal.classList.remove('show');
                modal.classList.add('hidden');
                currentEditingItem = null;
            }





            document.getElementById('category-filter').addEventListener('change', function (e) {
                renderAll();
            });







            const modal = document.getElementById('quick-editor-modal');
            const panel = document.getElementById('quick-editor-content');
            const handle = document.getElementById('quick-editor-title');
            const closeBtn = document.getElementById('quick-editor-close');

            const mainEl = document.querySelector('main');

            const WIDTH_THRESHOLD = 1300;

            // Remember original position so we can put it back
            const originalParent = panel.parentNode;

            // Move panel based on width

            if (!modal || !panel || !handle) return;

            // config
            const SNAP_MARGIN = 12;
            const STORAGE_KEY = 'quickEditorPosV1';

            // helpers
            const vw = () => window.innerWidth;
            const vh = () => window.innerHeight;
            const clamp = (v, a, b) => Math.max(a, Math.min(b, v));






            const centerPanel = () => {
                const w = panel.offsetWidth;
                setPanelPos(Math.round((vw() - w) / 2), Math.round(vh() * 0.1));
            };

            const setPanelPos = (left, top) => {
                // keep panel inside viewport (with margin)
                const W = panel.offsetWidth, H = panel.offsetHeight;
                const maxLeft = vw() - W - SNAP_MARGIN;
                const maxTop = vh() - H - SNAP_MARGIN;
                left = clamp(Math.round(left), SNAP_MARGIN, Math.max(SNAP_MARGIN, maxLeft));
                top = clamp(Math.round(top), SNAP_MARGIN, Math.max(SNAP_MARGIN, maxTop));

                panel.style.left = left + 'px';
                panel.style.top = top + 'px';
                panel.style.transform = 'none';
            };

            const savePosition = () => {
                try {
                    localStorage.setItem(STORAGE_KEY, JSON.stringify({
                        left: parseInt(panel.style.left || 0, 10),
                        top: parseInt(panel.style.top || 0, 10)
                    }));
                } catch { }
            };

            // pointer dragging
            let dragging = false;
            let startX = 0, startY = 0;
            let startLeft = 0, startTop = 0;

            // Use the whole panel as handle

            panel.addEventListener('pointerdown', onPointerDown);

            function onPointerDown(e) {
                //if parent of modal is main then do nothing
                if (panel.parentNode === mainEl) return;
                if (['INPUT', 'TEXTAREA', 'BUTTON', 'SELECT', 'SPAN', 'LI'].includes(e.target.tagName)) return;
                if (e.pointerType === 'mouse' && e.button !== 0) return;
                dragging = true;
                panel.classList.add('dragging');
                panel.setPointerCapture(e.pointerId);

                const rect = panel.getBoundingClientRect();
                startX = e.clientX;
                startY = e.clientY;
                startLeft = rect.left;
                startTop = rect.top;

                document.body.style.userSelect = 'none';
                e.preventDefault();
            }

            function onPointerMove(e) {
                if (!dragging) return;
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                setPanelPos(startLeft + dx, startTop + dy);
            }

            function onPointerUp(e) {
                if (!dragging) return;
                dragging = false;
                panel.classList.remove('dragging');

                const rect = panel.getBoundingClientRect();
                const leftDist = rect.left;
                const rightDist = vw() - (rect.left + rect.width);

                // Snap horizontally only, but to CORNERS vertically
                let finalLeft = leftDist < rightDist ? SNAP_MARGIN : vw() - rect.width - SNAP_MARGIN;

                // For corners: pick top or bottom based on closest
                const topDist = rect.top;
                const bottomDist = vh() - (rect.top + rect.height);
                let finalTop = topDist < bottomDist ? SNAP_MARGIN : vh() - rect.height - SNAP_MARGIN;

                // But if you want vertical to remain unchanged:
                // let finalTop = rect.top;

                setPanelPos(finalLeft, finalTop);
                savePosition();

                document.body.style.userSelect = '';
                try { panel.releasePointerCapture(e.pointerId); } catch { }
            }


            // attach pointer events

            window.addEventListener('pointermove', onPointerMove);
            window.addEventListener('pointerup', onPointerUp);


            const spacer = document.getElementById('quick-editor-spacer');
            function resizePanel() {
                if (vw() > WIDTH_THRESHOLD) {
                    mainEl.insertBefore(panel, mainEl.firstChild);
                    panel.style.position = 'fixed';
                    panel.style.left = spacer.offsetLeft + 'px';
                    panel.style.top = '96px';
                    panel.style.transform = 'none';
                    panel.style.boxShadow = '0 6px 24px var(--shade)';
                    panel.style.border = '1px solid var(--shade)';
                    panel.style.background = 'linear-gradient(137deg, #4a576163, #77839945, #4254622b)';
                    closeBtn.style.display = 'none';
                    spacer.style.display = 'unset';
                    spacer.style.width = panel.offsetWidth + 'px';
                    //set spacer height to main's height
                    if (vh() < panel.offsetHeight + 96) {
                        panel.style.position = 'absolute';
                    }
                } else {
                    if (!modal.contains(panel)) {
                        modal.appendChild(panel);
                        panel.style.position = 'fixed';
                        closeBtn.style.display = 'unset'; // show close button in modal
                        panel.style.boxShadow = '0 10px 30px rgba(0, 0, 0, 0.45)';
                        spacer.style.display = 'none';
                    }
                    // Keep it clamped inside view
                    const rect = panel.getBoundingClientRect();
                    const finalLeft = clamp(rect.left, SNAP_MARGIN, Math.max(SNAP_MARGIN, vw() - rect.width - SNAP_MARGIN));
                    const finalTop = clamp(rect.top, SNAP_MARGIN, Math.max(SNAP_MARGIN, vh() - rect.height - SNAP_MARGIN));
                    setPanelPos(finalLeft, finalTop);
                    savePosition();
                }
            }
            resizePanel()

            // optional: close button & Esc to close
            if (closeBtn) {
                closeBtn.addEventListener('click', () => modal.classList.add('hidden'));
            }


            // init when visible
            const observer = new MutationObserver(() => {
                if (!modal.classList.contains('hidden')) {
                    // slight delay to ensure layout computed
                    requestAnimationFrame(() => resizePanel());
                }
            });
            observer.observe(modal, { attributes: true, attributeFilter: ['class'] });

            // initial restore if already visible
            if (!modal.classList.contains('hidden')) resizePanel();


            document.getElementById('sort-select').addEventListener('change', () => renderAll());
            const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            if (!isTouch) {
                setupDragDrop();
            }

            loadHistory();

            // Create a hidden span for measuring text width
            const span = document.createElement('span');
            span.style.position = 'absolute';
            span.style.visibility = 'hidden';
            span.style.height = 'auto';
            span.style.width = 'auto';
            span.style.whiteSpace = 'nowrap';
            span.style.fontSize = getComputedStyle(input).fontSize;
            span.style.fontWeight = getComputedStyle(input).fontWeight;
            span.style.fontFamily = getComputedStyle(input).fontFamily;
            document.body.appendChild(span);

            function updateWidth() {
                span.textContent = input.value || input.placeholder;
                const width = span.offsetWidth + 94; // 20px padding for comfort
                priceArea.style.width = width + 'px';
            }

            input.addEventListener('input', updateWidth);
            updateWidth();
        }


        const canvas = document.getElementById("overlay");
        const ctx = canvas.getContext("2d");
        const adminkey = document.getElementById("admin-key");
        const loginbtn = document.getElementById("login-btn");

        adminkey.onfocus = () => {
            target = loginbtn
        }

        loginbtn.onclick = () => {
            target = null
        }

        let target = adminkey

        const updateCanvasSize = () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        };

        // Handle window resize
        
        updateCanvasSize();

        // Mouse position
        let mouse = { x: null, y: null };
        window.addEventListener("mousemove", (e) => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
        });

        // Draw arrow function
        const drawArrow = () => {
            const x0 = mouse.x;
            const y0 = mouse.y;

            if (!x0 || !y0) return;
            if (target == null) return;
            if (arrowoff) return;

            // Get target center
            const rect = target.getBoundingClientRect();
            const cx = rect.left + rect.width / 2;
            const cy = rect.top + rect.height / 2;

            // Add target size
            const a = Math.atan2(cy - y0, cx - x0);
            const x1 = cx - Math.cos(a) * (rect.width / 2 + 12);
            const y1 = cy - Math.sin(a) * (rect.height / 2 + 12);

            const midX = (x0 + x1) / 2;
            const midY = (y0 + y1) / 2;
            const offset = Math.min(200, Math.hypot(x1 - x0, y1 - y0) * 0.5);
            const t = Math.max(-1, Math.min(1, (y0 - y1) / 200));
            const controlX = midX;
            const controlY = midY + offset * t;

            const r = Math.sqrt((x1 - x0) ** 2 + (y1 - y0) ** 2);
            const opacity = Math.min(0.75, (r - Math.max(rect.width, rect.height) / 4) / 750);

            ctx.strokeStyle = `rgba(255,255,255,${opacity})`;
            ctx.lineWidth = 1;

            // Draw curve
            ctx.save();
            ctx.beginPath();
            ctx.moveTo(x0, y0);
            ctx.quadraticCurveTo(controlX, controlY, x1, y1);
            ctx.setLineDash([10, 4]);
            ctx.stroke();
            ctx.restore();

            // Draw arrowhead
            const angle = Math.atan2(y1 - controlY, x1 - controlX);
            const headLength = 10;
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(
                x1 - headLength * Math.cos(angle - Math.PI / 6),
                y1 - headLength * Math.sin(angle - Math.PI / 6)
            );
            ctx.moveTo(x1, y1);
            ctx.lineTo(
                x1 - headLength * Math.cos(angle + Math.PI / 6),
                y1 - headLength * Math.sin(angle + Math.PI / 6)
            );
            ctx.stroke();
        };

        // Animation loop
        const animate = () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            drawArrow();

            requestAnimationFrame(animate);
        };

        animate();


        let notes = [];

        function renderNotes() {
            const notesArea = document.getElementById('notesArea');
            notesArea.innerHTML = '';

            notes.forEach((note, index) => {
                const noteElement = document.createElement('div');
                noteElement.className = 'stickynote';
                noteElement.dataset.index = index; // Keep track of index
                noteElement.innerHTML = `
                    <div class="pin"></div>
                    <div class="note-content">${note.content}</div>
                    <div class="note-author">${escapeHtml('@' + note.author || '')}</div>
                    <div class="note-time">${formatTime(note.timestamp)}</div>
                `;

                notesArea.appendChild(noteElement);

                // Right click (desktop)
                noteElement.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    promptDelete(index);
                });

                // Long press (mobile)
                let pressTimer;
                noteElement.addEventListener('touchstart', () => {
                    pressTimer = setTimeout(() => {
                        promptDelete(index);
                    }, 600); // hold for 600ms
                });
                noteElement.addEventListener('touchend', () => {
                    clearTimeout(pressTimer);
                });
            });

            // Auto-scroll to latest
            notesArea.scrollTop = notesArea.scrollHeight;
        }

        function promptDelete(index) {
            const note = notes[index];
            if (!note) return;

            if (confirm("Delete this note?")) {
                ws2.send(JSON.stringify({ type: "delete", id: note.id, author: myAdminName }));
                // Optimistically remove
                notes.splice(index, 1);
                renderNotes();
            }
        }


        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);

            if (diffMins < 1) return 'now';
            if (diffMins < 60) return `${diffMins}m`;
            if (diffMins < 1440) return `${Math.floor(diffMins / 60)}h`;
            return `${Math.floor(diffMins / 1440)}d`;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }


        function toggleAddForm() {
            const addButton = document.getElementById('addButton');
            const inputForm = document.getElementById('inputForm');

            if (!addButton.classList.contains('expanded')) {

                addButton.classList.add('expanded');
                addButton.classList.remove('add-button');
                addButton.innerHTML = '';
                addButton.appendChild(inputForm);
                inputForm.classList.add('active');

                // Focus the input after animation
                setTimeout(() => {
                    document.getElementById('noteInput').focus();
                }, 300);
            }
        }



        function cancelNote() {
            const addButton = document.getElementById('addButton');
            const inputForm = document.getElementById('inputForm');
            const noteInput = document.getElementById('noteInput');

            addButton.classList.add('add-button');
            addButton.classList.remove('expanded');
            inputForm.classList.remove('active');
            addButton.innerHTML = '+';
            noteInput.value = '';

            // Move form back to its container
            document.body.appendChild(inputForm);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function (e) {
            const inputForm = document.getElementById('inputForm');

            if (inputForm.classList.contains('active')) {
                if (e.key === 'Escape') {
                    cancelNote();
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    sendNote();
                }
            }
        });

        // Click outside to close
        document.addEventListener('click', function (e) {
            const addButton = document.getElementById('addButton');
            const inputForm = document.getElementById('inputForm');


            if (inputForm.classList.contains('active') &&
                !addButton.contains(e.target) &&
                !inputForm.contains(e.target)) {

                cancelNote();
            }
        });
        let ws2;

        function initWebSocket2() {
            ws2 = new WebSocket("wss://notes-board.xnite7.workers.dev");

            ws2.onopen = () => {
                console.log("Connected to notes WebSocket");
            };

            ws2.onmessage = (event) => {
                const msg = JSON.parse(event.data);

                if (msg.type === "init") {
                    notes = msg.notes;
                    renderNotes();
                } else if (msg.type === "create") {
                    notes.push(msg.note);
                    renderNotes();
                } else if (msg.type === "delete") {
                    notes = notes.filter(n => n.id !== msg.id);
                    renderNotes();
                }
            };

            ws2.onclose = () => {
                console.log("WS closed, retrying in 2s...");
                setTimeout(initWebSocket2, 2000);
            };
        }
        initWebSocket2();

        function sendNote() {
            const noteInput = document.getElementById('noteInput');
            const content = noteInput.value.trim();

            if (content === '') {
                noteInput.focus();
                return;
            }

            // Send via WebSocket
            ws2.send(JSON.stringify({ type: "create", content, author: myAdminName }));

            cancelNote();
        }



    </script>

</body>

</html>