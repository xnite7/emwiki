<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>EM Wiki - The Complete Epic Minigames Wiki</title>
	<!-- Meta tags -->
	<meta name="description"
		content="by @xnite! A fun corner of the web where you can check out all the Epic Minigames items on Roblox, always updating!" />
	<meta name="keywords" content="Epic minigames, Epic minigames wiki, emwiki, em wiki, Epic Minigames Values">
	<meta property="og:title" content="Epic Catalogue - The Complete EM Catalogue">
	<meta property="og:image" content="https://emwiki.com/imgs/QgWIUWf.png" />
	<meta property="og:description"
		content="by @xnite! A fun corner of the web where you can check out all the Epic Minigames items on Roblox!">

	<link rel="icon" href="./imgs/favicon.png" type="image/png">
	<link rel="apple-touch-icon" href="./imgs/app.png">
	<link rel="manifest" href="/site.webmanifest">
	<meta name="theme-color" content="#000000">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

	<!-- Preload critical CSS to prevent FOUC -->
	<link rel="stylesheet" href="./css/style.css">

	<!-- Popover compatibility for older browsers -->
	<script src="./js/popover-loader.js"></script>

	<!-- Critical inline styles for instant render -->
	<style>
		body {
			min-height: 100vh;
			background-image: none;
			background-repeat: space;
			background-position: center;
			background-attachment: fixed;
			opacity: 0;
			animation: fadeIn 1s ease-out forwards;
		}

		@keyframes fadeIn {
			99% {
				background-image: none;
			}

			to {
				opacity: 1;
				background-image: url(./imgs/bg.png);
			}

		}

		@media screen and (max-width: 2062px) {
			body {
				background-repeat: repeat;
			}
		}

		/* Pet Styles */
		#petContainer {
			position: absolute;
			bottom: 20px;
			left: 50px;
			width: 32px;
			height: 32px;
			z-index: 100;
			cursor: pointer;
			overflow: visible;
		}

		#pet {
			width: 32px;
			height: 32px;
			image-rendering: pixelated;
			image-rendering: -moz-crisp-edges;
			image-rendering: crisp-edges;
			background: url('https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/versions/generation-v/black-white/animated/49.gif') no-repeat center;
			background-size: contain;
		}

		#petContainer.walking {
			animation: bounce 0.5s ease-in-out infinite;
		}

		#petContainer.idle {
			animation: idle 2s ease-in-out infinite;
		}

		#pet.flipped {
			transform: scaleX(-1);
		}

		@keyframes bounce {

			0%,
			100% {
				transform: translateY(0);
			}

			50% {
				transform: translateY(-3px);
			}
		}

		@keyframes idle {

			0%,
			100% {
				transform: translateY(0) scale(1);
			}

			50% {
				transform: translateY(-1px) scale(1.05);
			}
		}

		.heart {
			position: absolute;
			bottom: 35px;
			left: 50%;
			transform: translateX(-50%);
			font-size: 20px;
			animation: floatHeart 1s ease-out forwards;
			pointer-events: none;
			z-index: 200;
		}

		@keyframes floatHeart {
			0% {
				opacity: 1;
				transform: translateX(-50%) translateY(0) scale(0.5);
			}

			50% {
				transform: translateX(-50%) translateY(-20px) scale(1);
			}

			100% {
				opacity: 0;
				transform: translateX(-50%) translateY(-40px) scale(0.8);
			}
		}
	</style>

	<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.js"></script>
	<script
		src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
	<!-- Three.js for 3D player model -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/OBJLoader.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/MTLLoader.js"></script>
</head>

<body>

	<!-- Header with modern catalog style -->
	<header>
		<div id="christmaslights"
			style="display:none;position: absolute;left: 0;top: -45px;background: url(./imgs/titles/7a889a5ce371c6aa3a59862815826ee7.png);background-position: center;width: 100%;height: 40%;z-index: -1;">
		</div>
		<a href="https://emwiki.com">
			<svg width="500" height="300" viewBox="451 471 100 39" xmlns="http://www.w3.org/2000/svg">
				<defs>
					<linearGradient id="eppp1" y1="1" x2="0">
						<stop offset=".2" style="stop-color:#ff0" />
						<stop offset="1" style="stop-color:#24ff5a" />
					</linearGradient>
					<linearGradient id="eppp2" y1="1" x2="0">
						<stop offset="0" style="stop-color:#24ff5d" />
						<stop offset="1" style="stop-color:#ff0" />
					</linearGradient>
				</defs>
				<image id="cloud" x="461" y="459" href="https://emwiki.com/imgs/TWOKPhY.png" height="60" width="60"
					style="filter:opacity(.6)" />
				<text x="489" y="503" text-anchor="middle" stroke="#000" stroke-width="2.3" paint-order="stroke"
					stroke-linejoin="round" fill="url(#eppp1)"
					style="animation:floatAnim 12s ease-in-out infinite;font:200 46px Slapstick">EM</text>
				<image id="epic-image" x="464" y="463" href="https://emwiki.com/imgs/epicfaces/kitta.png" height="60"
					width="60"
					style="scale:.48;transform:translate(846px,103px);rotate:20deg;transform-origin:center;animation:floatAnim2 15s ease-in-out 1s infinite alternate" />
				<image id="cloud" x="495" y="477" href="https://emwiki.com/imgs/8UUB0Gt.png" height="60" width="60"
					style="filter:opacity(.86)" />
				<text x="516" y="514" text-anchor="middle" stroke="#000" stroke-width="2.3" paint-order="stroke"
					stroke-linejoin="round" fill="url(#eppp2)"
					style="animation:floatAnim 12s ease-in-out infinite;animation-delay:5.5s;font:200 16px Slapstick">wiki</text>
				<image id="cloud" x="445" y="487" href="https://emwiki.com/imgs/oYKd3nJ.png" height="28" width="42"
					style="filter:opacity(.8)" />
			</svg>

		</a>

		<div class="nav-links">
			<a href="/catalog" class="nav-link">Catalog</a>
			<a href="/trading" class="nav-link">Trading Hub</a>
			<a href="/forum" class="nav-link">Forum</a>
			<a href="/gallery" class="nav-link">Gallery</a>
			<a href="/scammers" class="nav-link">Scammers</a>
		</div>


	</header>

	<!-- Hero Section -->
	<section class="hero-section">
		<div class="hero-content">
			<div class="hero-title">
				<h1 class="hero-epic">Epic Minigames</h1>
				<h3 class="hero-catalogue">Wiki</h3>
			</div>
			<p class="hero-subtitle">The Complete Epic Minigames Wiki</p>

			<!-- Search Bar -->
			<div class="search-container">
				<input id="search-bar" type="text" placeholder="Search items..." />
				<button class="search-btn">
					<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
						<circle cx="11" cy="11" r="8"></circle>
						<path d="m21 21-4.35-4.35"></path>
					</svg>
				</button>
				<div id="search-results" class="search-results"></div>
			</div>

			<!-- Quick Stats -->
			<div class="quick-stats">
				<div class="stat-card">
					<h2 class="stat-value" id="total-items">0</h2>
					<div class="stat-label">Total Items</div>
				</div>

				<div class="stat-card">
					<h2 class="stat-value" id="new-items">0</h2>
					<div class="stat-label">New Items</div>
				</div>
			</div>
		</div>
		<button class="stats-btn" onclick="catalog.openStats()">My Lists</button>
	</section>

	<!-- Category Navigation -->
	<div style="display: none;" class="category-nav-container">
		<div class="category-nav">
			<button class="category-btn active" data-category="all">
				<img src="./imgs/XwkWVJJ.png" alt="All">
				<span>All Items</span>
			</button>
			<button class="category-btn" data-category="gears">
				<img src="./imgs/AYUbTJv.png" alt="Gears">
				<span>Gears</span>
			</button>
			<button class="category-btn" data-category="deaths">
				<img src="./imgs/fADZwOh.png" alt="Deaths">
				<span>Deaths</span>
			</button>
			<button class="category-btn" data-category="pets">
				<img src="./imgs/GHXB0nC.png" alt="Pets">
				<span>Pets</span>
			</button>
			<button class="category-btn" data-category="effects">
				<img src="./imgs/l90cgxf.png" alt="Effects">
				<span>Effects</span>
			</button>
			<button class="category-btn" data-category="titles">
				<img src="./imgs/ZOP8l9g.png" alt="Titles">
				<span>Titles</span>
			</button>
		</div>
	</div>

	<!-- Main Content -->
	<main>
		<div class="lists-grid">
			<!-- Newest Items Section -->
			<section class="content-section">
				<div class="section-header">
					<h2 class="section-title"> New Items</h2>
					<a href="/catalog?filter=new" class="see-all-btn">See All ‚Üí</a>
				</div>
				<div class="items-grid" id="new-items-grid"></div>
			</section>

			<!-- Weekly Shop Section -->
			<section class="content-section">
				<div class="section-header">
					<h2 class="section-title">üìÜ Weekly Shop</h2>
					<div class="countdown" id="countdown-shop">00:00:00</div>
				</div>
				<div class="items-grid" id="weekly-shop-grid"></div>
			</section>

			<!-- Weekly Rotation Section -->
			<section class="content-section">
				<div class="section-header">
					<h2 class="section-title"> Weekly Rotation</h2>
					<div class="countdown" id="countdown-rotation">00:00:00</div>
				</div>
				<div class="items-grid" id="weekly-rotation-grid"></div>
			</section>


		</div>

		<!-- Info Cards Row -->
		<div class="info-cards-row">
			<!-- Donators Card -->
			<div class="info-card donators-card">
				<h3 class="card-title"> Donations</h3>
				<div id="donators-list" class="donators-list">
					<div class="donator-skeleton">Loading...</div>
				</div>
				<button class="donate-btn"
					onclick="window.open('https://www.roblox.com/games/122649225404413/EMWIKI-Account-Linker', '_blank');">
					<span>Donate</span>
					<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
						<path fill="#000"
							d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
					</svg>
				</button>
				<small class="donate-note">all ur donations are deeply appreciated &lt;3</small>
			</div>

			<!-- Patch Notes Card -->
			<div class="info-card patch-notes-card">
				<h3 class="card-title"> Patch Notes</h3>
				<div class="patch-date">Last updated: Dec 23, 2025</div>
				<ul class="patch-list">
					<li class="patch-new">Christmas Update</li>
					<li>Merry Christmas! üéÑ</li>
					<li>Check out the new "Made by" Filter!</li>
					<li>View Other's Wishlists on their Profile Page!</li>
					<li>and Write Reviews on their Profile Page!</li>
				</ul>
				<div class="patch-link">View Full Changelog ‚Üí</div>
			</div>
			<!-- Random Items Section -->
			<div class="info-card refresh-card">
				<div class="section-header">
					<h2 class="card-title"> Random Item</h2>
					<button class="refresh-btn" onclick="catalog.refreshRandom()">
						<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
							<path
								d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" />
						</svg>
					</button>
				</div>
				<div class="items-grid" id="random-items-grid"></div>
			</div>
		</div>



		<!-- Quick Links -->
		<div class="quick-links">
			<a href="https://discord.com/invite/tg" class="quick-link discord">
				<img src="./imgs/discord.png" alt="Discord">
				<span>TG Discord</span>
			</a>
			<a href="https://discord.gg/WZwRgZuEyQ" class="quick-link anuc">
				<img src="./imgs/anuc.gif" alt="Discord">
				<span>Our Discord</span>
			</a>


			<a href="/burrito" class="quick-link burrito">
				<img src="./imgs/burrito.png" alt="Burrito Game">
				<span>Burrito</span>
			</a>
			<a href="/cat" class="quick-link cat">
				<img src="./imgs/cats/heart.png" alt="Cat">
				<span>Cat</span>
			</a>
		</div>
	</main>

	<!-- Footer -->
	<footer>
		<div class="footer-content">
			<div class="footer-section">
				<h4>Browse</h4>
				<a href="/catalog">Catalog</a>
				<a href="/scammers">Scammers List</a>
				<a href="/admin">Admin Portal</a>
			</div>
			<div class="footer-section">
				<h4>Community</h4>
				<a href="/forum">Forum</a>
				<a href="/trading">Trading</a>
				<a href="/lookinglogo">Gallery</a>
				<a href="https://discord.com/invite/tg">Typical Games Discord</a>
			</div>
			<div class="footer-section">
				<h4>Contact</h4>
				<p>Found a bug? Reach out to <b>@xnite</b> on Discord!</p>
				<a id="kypsus"
					href="https://docs.google.com/spreadsheets/d/11qKj8UTf2-x0Z7bNMuguEFKALCWI1v7QtkDbNlBzy9M">
					<strong>@Kypsus</strong>'s Google Sheet</a>
			</div>
		</div>
		<div class="footer-bottom">
			<p>¬© 2025 emwiki.com ‚Ä¢ made with ‚ù§ by <span id="xnite-link"
					style="cursor: pointer; text-decoration: underline;">xnite</span></p>
		</div>
		<!-- Pet -->
		<div id="petContainer">
			<div id="pet"></div>
		</div>
	</footer>



	<script src="./js/script.js"></script>
	<script>
		class Catalog extends BaseApp {
			constructor() {
				super();
				this.currentCategory = 'all';
				this.countdownManager = new CountdownManager();
				this.init();

			}

			async init() {
				// Check for ?item parameter and redirect to catalog
				const url = new URL(window.location);
				const itemParam = url.searchParams.get('item');
				if (itemParam) {
					window.location.href = `/catalog?item=${itemParam}`;
					return;
				}

				await this.loadData();
				await this.loadPreferences();
				this.setupEventListeners();
				this.countdownManager.add('countdown-shop');
				this.countdownManager.add('countdown-rotation');
				//this.countdownManager.start();
				document.querySelector('.patch-link').addEventListener('click', () => {
					Utils.showToast(':3', 'poop update coming soon', 'info');
				});
				const totalItems = this.allItems.length;
				document.getElementById('total-items').textContent = totalItems;
				const newItems = this.allItems.filter(item => item.new).length;
				document.getElementById('new-items').textContent = newItems;

				this.loadDonators();
				this.populateGrids();
				this.initializeSearch();
			}



			setupEventListeners() {
				document.querySelectorAll('.category-btn').forEach(btn => {
					btn.addEventListener('click', () => {
						document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
						btn.classList.add('active');
						this.currentCategory = btn.dataset.category;
						this.populateGrids();
					});
				});

				// Add dev shortcut
				document.getElementById('search-bar').addEventListener('keypress', (e) => {
					if (e.key === 'Enter') {
						if (e.target.value.toLowerCase().trim() === 'dev') {
							window.location.href = '/admin';
						}

					}
				});
			}

			populateGrids() {
				const newItems = this.allItems.filter(item => item.new).slice(0, 50);
				this.renderItems('new-items-grid', newItems);

				const weeklyShop = this.allItems.filter(item => item.weekly).slice(0, 8);
				this.renderItems('weekly-shop-grid', weeklyShop);

				const weeklyRotation = this.allItems.filter(item => item.weeklystar).slice(0, 8);
				this.renderItems('weekly-rotation-grid', weeklyRotation);

				this.refreshRandom();
			}

			renderItems(gridId, items) {
				const grid = document.getElementById(gridId);
				if (!grid) return;

				grid.innerHTML = '';

				items.forEach(item => {
					const div = this.createItemElement(item)
					const priceCodeRarity = item['price/code/rarity'];
					if (item.weeklystar) {
						div.querySelector('.item-price').textContent = priceCodeRarity?.toLowerCase().split('<br>').pop().replace(' stars', '');
						div.querySelector('.item-price').classList.replace('item-price', 'star-price');
						const outlineColors = {
							'60': '#b31aff',
							'30': '#ff2a00',
							'15': '#fae351',
							'5': '#e0e6df'
						};
						Object.entries(outlineColors).forEach(([num, color]) => {
							if (priceCodeRarity.toLowerCase().includes(num)) {
								div.style.outline = `4px solid ${color}`;
								div.style.background = 'unset';
							}
						});

					} else if (item.weekly) {
						if (priceCodeRarity) {
							const coinValue = priceCodeRarity?.toLowerCase().split('<br>').pop().replace(' coins', '').trim();
							if (coinValue) {
								div.querySelector('.item-price').textContent = coinValue;
								div.querySelector('.item-price').classList.add('coin-price');
								div.querySelector('.item-price').classList.replace('item-price', 'star-price');
							}
						}

					} else if (item.new) {
						if (priceCodeRarity?.toLowerCase().includes('unobtainable')) {
							div.style.order = 1;
						}
					}

					grid.appendChild(div);
				});
			}

			refreshRandom() {
				const randomItems = [];
				const myButton = document.querySelector('.refresh-btn');

				myButton.addEventListener('click', () => {
					myButton.classList.add('active');
					setTimeout(() => myButton.classList.remove('active'), 300);
				});

				for (let i = 0; i < 1; i++) {
					const randomIndex = Math.floor(Math.random() * this.allItems.length);
					randomItems.push(this.allItems[randomIndex]);
				}

				this.renderItems('random-items-grid', randomItems);
			}

			async loadDonators() {
				try {
					const res = await fetch('https://emwiki.com/api/donations');
					const data = await res.json();

					const donatorsList = document.getElementById('donators-list');
					donatorsList.innerHTML = '';

					const topDonators = data.sort((a, b) => b.amount - a.amount).slice(0, 4);

					topDonators.forEach(donator => {
						const div = document.createElement('div');
						div.className = 'donator-item';
						div.innerHTML = `
                    <img class="donator-avatar" src="${donator.avatar || 'https://emwiki.com/imgs/plr.jpg'}" alt="${donator.displayName}">
                    <div class="donator-name">${donator.displayName}</div>
                    <div class="donator-amount">${Utils.formatPrice(donator.totalSpent)}</div>
                `;
						donatorsList.appendChild(div);
					});
				} catch (error) {
					console.error('Failed to load donators:', error);
				}
			}
		}

		window.catalog = new Catalog();

		// ==================== SNOW PARTICLES (CHRISTMAS) ====================
		class SnowParticleSystem {
			constructor() {
				// Check if it's December (Christmas season)
				const now = new Date();
				const month = now.getMonth(); // 0-11, where 11 is December
				if (month !== 11) return; // Only show in December

				document.getElementById('christmaslights').style.display = 'block';

				this.canvas = document.createElement('canvas');
				this.canvas.id = 'snow-canvas';
				this.canvas.style.position = 'fixed';
				this.canvas.style.top = '0';
				this.canvas.style.left = '0';
				this.canvas.style.width = '100%';
				this.canvas.style.height = '100%';
				this.canvas.style.pointerEvents = 'none';
				this.canvas.style.zIndex = '1';
				this.canvas.style.opacity = '0.6';
				document.body.appendChild(this.canvas);

				this.ctx = this.canvas.getContext('2d');
				this.particles = [];
				this.maxParticles = 25; // Reduced amount
				this.animationFrame = null;

				this.resize();
				window.addEventListener('resize', () => this.resize());
				this.init();
			}

			resize() {
				this.canvas.width = window.innerWidth;
				this.canvas.height = window.innerHeight;
			}

			createParticle() {
				return {
					x: Math.random() * this.canvas.width,
					y: Math.random() * -200 - 50, // Start above screen
					vx: (Math.random() - 0.5) * 0.5, // Gentle horizontal drift
					vy: Math.random() * 0.5 + 0.3, // Slow fall speed
					size: Math.random() * 3 + 1.5, // Small, subtle flakes
					opacity: Math.random() * 0.5 + 0.3, // Semi-transparent
					swing: Math.random() * Math.PI * 2, // For gentle swaying
					swingSpeed: Math.random() * 0.02 + 0.01
				};
			}

			init() {
				// Create initial particles
				for (let i = 0; i < this.maxParticles; i++) {
					this.particles.push(this.createParticle());
				}

				// Spawn new particles occasionally
				setInterval(() => {
					if (this.particles.length < this.maxParticles) {
						this.particles.push(this.createParticle());
					}
				}, 4000);

				this.animate();
			}

			animate() {
				this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

				for (let i = this.particles.length - 1; i >= 0; i--) {
					const p = this.particles[i];

					// Update swing for gentle horizontal movement
					p.swing += p.swingSpeed;
					p.x += Math.sin(p.swing) * 0.3 + p.vx;
					p.y += p.vy;

					// Reset if off screen
					if (p.y > this.canvas.height + 10) {
						p.x = Math.random() * this.canvas.width;
						p.y = -10;
						p.vx = (Math.random() - 0.5) * 0.5;
					}

					// Wrap horizontally
					if (p.x < -5) p.x = this.canvas.width + 5;
					if (p.x > this.canvas.width + 5) p.x = -5;

					// Draw snowflake with Gaussian blur effect using radial gradient
					this.ctx.save();
					this.ctx.globalAlpha = p.opacity;

					// Create a radial gradient for Gaussian blur effect
					const gradient = this.ctx.createRadialGradient(
						p.x, p.y, 0,
						p.x, p.y, p.size * 2
					);
					gradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');
					gradient.addColorStop(0.3, 'rgba(255, 255, 255, 0.5)');
					gradient.addColorStop(0.6, 'rgba(255, 255, 255, 0.2)');
					gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');

					this.ctx.fillStyle = gradient;
					this.ctx.beginPath();
					this.ctx.arc(p.x, p.y, p.size * 2, 0, Math.PI * 2);
					this.ctx.fill();
					this.ctx.restore();
				}

				this.animationFrame = requestAnimationFrame(() => this.animate());
			}

			stop() {
				if (this.animationFrame) {
					cancelAnimationFrame(this.animationFrame);
				}
				if (this.canvas && this.canvas.parentNode) {
					this.canvas.parentNode.removeChild(this.canvas);
				}
			}
		}

		// Initialize snow particles if it's December
		const snowSystem = new SnowParticleSystem();

		// ==================== PET SYSTEM ====================
		const pet = document.getElementById('petContainer');
		const pet2 = document.getElementById('pet');
		const xniteLink = document.getElementById('xnite-link');
		const footer = document.querySelector('footer');

		let petState = {
			x: 50,
			direction: 1,
			speed: 1.5,
			isWalking: true,
			isIdle: false,
			isPlaying: false,
			destination: null
		};

		function movePet() {
			if (petState.isIdle || petState.isPlaying) return;

			const footerRect = footer.getBoundingClientRect();
			const maxX = footerRect.width - 32;

			// Check if pet has a destination (xnite link)
			if (petState.destination !== null) {
				const xniteRect = xniteLink.getBoundingClientRect();
				// Calculate position relative to footer
				const targetX = xniteRect.left - footerRect.left + (xniteRect.width / 2) - 16;
				const currentLeft = parseInt(pet.style.left) || 50;
				const currentBottom = parseInt(pet.style.bottom) || 20;
				const targetBottom = footerRect.height - (xniteRect.top - footerRect.top) + 10;
				const distanceX = targetX - currentLeft;
				const distanceY = targetBottom - currentBottom;

				if (Math.abs(distanceX) < 15 && Math.abs(distanceY) < 15) {
					// Reached xnite - position exactly above it
					petState.x = targetX;
					pet.style.left = petState.x + 'px';
					pet.style.bottom = targetBottom + 'px';
					petState.destination = null;
					petState.isWalking = false;
					petState.isPlaying = true;
					pet.classList.remove('walking');
					pet.classList.add('idle');
					playWithXnite();
					setTimeout(() => {
						petState.isPlaying = false;
						petState.isWalking = true;
						pet.classList.remove('idle');
						pet.classList.add('walking');
						randomDirection();
					}, 3000);
				} else {
					// Move towards xnite
					petState.direction = distanceX > 0 ? 1 : -1;
					petState.x += petState.speed * petState.direction * 2;
					if (Math.abs(distanceY) > 5) {
						const newBottom = currentBottom + (distanceY > 0 ? 1 : -1) * petState.speed * 1.5;
						pet.style.bottom = Math.max(20, Math.min(footerRect.height - 20, newBottom)) + 'px';
					}
				}
			} else {
				// Random walking within footer bounds
				petState.x += petState.speed * petState.direction;

				// Bounce off edges of footer
				if (petState.x <= 0 || petState.x >= maxX) {
					petState.direction *= -1;
				}

				// Random direction change
				if (Math.random() < 0.008) {
					randomDirection();
				}

				// Random idle
				if (Math.random() < 0.005) {
					idle();
				}
			}

			// Update pet position (keep within footer bounds)
			petState.x = Math.max(0, Math.min(maxX, petState.x));
			pet.style.left = petState.x + 'px';

			// Flip sprite based on direction
			if (petState.direction > 0) {
				pet2.classList.add('flipped');
			} else {
				pet2.classList.remove('flipped');
			}
		}

		function randomDirection() {
			petState.direction = Math.random() > 0.5 ? 1 : -1;
		}

		function idle() {
			petState.isWalking = false;
			petState.isIdle = true;
			pet.classList.remove('walking');
			pet.classList.add('idle');

			setTimeout(() => {
				petState.isIdle = false;
				petState.isWalking = true;
				pet.classList.remove('idle');
				pet.classList.add('walking');
			}, 2000 + Math.random() * 2000);
		}

		function playWithXnite() {
			// Pet plays with xnite
		}

		// Click interaction on pet
		pet.addEventListener('click', () => {
			const heart = document.createElement('div');
			heart.className = 'heart';
			heart.textContent = '‚ù§Ô∏è';
			pet.appendChild(heart);

			setTimeout(() => {
				heart.remove();
			}, 1000);
		});

		// Xnite link click - pet goes to footer
		xniteLink.addEventListener('click', () => {
			if (!petState.isPlaying) {
				petState.destination = true; // Set destination flag
			}
		});

		// Main game loop
		setInterval(movePet, 50);

		// Sometimes go to footer randomly
		setInterval(() => {
			if (Math.random() < 0.2 && !petState.isPlaying && petState.destination === null) {
				petState.destination = true; // Set destination flag
			}
		}, 8000);
	</script>

</body>

</html>